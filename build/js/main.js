"use strict";

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }
function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }
function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }
var cells = document.querySelectorAll('.cell');
var statusText = document.getElementById('status');
var statusTextInfo = document.getElementById('status-text');
var statusContainer = document.querySelector(".land__left");
var statusBox = document.querySelector(".land__status");
var restartBtns = document.querySelectorAll('.restart-game');
var overlay = document.querySelector(".overlay");
var sideBtns = document.querySelectorAll('.side-btn');
var startGame = document.querySelector('.start-game');
var gameContainer = document.getElementById('game');
var landWrapper = document.querySelector('.land');
var statusIconX = document.querySelector('[data-player="X"]');
var statusIconO = document.querySelector('[data-player="O"]');
var gameGrid = document.querySelector('.game-grid');
var persLeft = document.querySelector('.game-pers._left');
var persRight = document.querySelector('.game-pers._right');
var gameOverText = document.querySelector('.game-over');
var board = ['', '', '', '', '', '', '', '', ''];
var isComputerX = true;
var currentPlayer, computerPlayer;
document.body.style.overflow = "hidden";
if (isComputerX) {
  document.querySelector('[data-side="X"]').classList.remove('_active');
  document.querySelector('[data-side="0"]').classList.add('_active');
} else {
  document.querySelector('[data-side="0"]').classList.remove('_active');
  document.querySelector('[data-side="X"]').classList.add('_active');
}
var winningCombos = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
function initializeGame() {
  currentPlayer = isComputerX ? 'Гравець 02' : 'Гравець 01';
  computerPlayer = isComputerX ? 'Гравець 01' : 'Гравець 02';
  board = ['', '', '', '', '', '', '', '', ''];
  cells.forEach(function (cell) {
    cell.textContent = '';
    cell.classList.remove('taken', 'X-player', 'O-player');
  });
  var line = document.querySelector('.win-line');
  if (line) {
    line.style.transform = 'scaleX(0)';
  }
  checkStatusIcon(currentPlayer);
  checkStatusContainer(currentPlayer);
  statusText.textContent = "".concat(currentPlayer);
  statusTextInfo.textContent = "\u0422\u0412\u0406\u0419_\u0425\u0406\u0414";
  if (currentPlayer === computerPlayer) {
    setTimeout(bestMove, 500);
  }
}
function checkStatusIcon(player) {
  if (player === 'Гравець 01') {
    statusIconX.classList.add("_active");
    statusIconO.classList.remove("_active");
  }
  if (player === 'Гравець 02') {
    statusIconO.classList.add("_active");
    statusIconX.classList.remove("_active");
  }
}
function checkStatusContainer(player) {
  if (player === 'Гравець 01') {
    statusBox.classList.add("X-player");
    statusBox.classList.remove("O-player");
  }
  if (player === 'Гравець 02') {
    statusBox.classList.add("O-player");
    statusBox.classList.remove("X-player");
  }
}
function checkWinner(player) {
  var _iterator = _createForOfIteratorHelper(winningCombos),
    _step;
  try {
    for (_iterator.s(); !(_step = _iterator.n()).done;) {
      var combo = _step.value;
      if (combo.every(function (index) {
        return board[index] === player;
      })) {
        return combo;
      }
    }
  } catch (err) {
    _iterator.e(err);
  } finally {
    _iterator.f();
  }
  return null;
}
function isDraw() {
  return board.every(function (cell) {
    return cell !== '';
  });
}
function bestMove() {
  setTimeout(function () {
    var bestScore = -Infinity;
    var move;
    for (var i = 0; i < board.length; i++) {
      if (board[i] === '') {
        board[i] = computerPlayer;
        var score = minimax(board, 0, false);
        board[i] = '';
        if (score > bestScore) {
          bestScore = score;
          move = i;
        }
      }
    }
    board[move] = computerPlayer;
    if (computerPlayer === "Гравець 02") {
      cells[move].classList.add('O-player');
    }
    if (computerPlayer === "Гравець 01") {
      cells[move].classList.add('X-player');
    }
    checkStatusIcon(computerPlayer);
    checkStatusContainer(currentPlayer);
    statusTextInfo.textContent = "\u0427\u0415\u041A\u0410\u0419";
    cells[move].classList.add('taken');
    var winningCombo = checkWinner(computerPlayer);
    if (winningCombo) {
      showWinLine(winningCombo);
      setTimeout(function () {
        statusText.textContent = "".concat(computerPlayer);
        hideAfterGame("lose");
        endGame();
      }, 1000);
    } else if (isDraw()) {
      hideAfterGame("draw");
      statusText.textContent = "Нічия!";
    } else {
      setTimeout(function () {
        currentPlayer = currentPlayer === 'Гравець 01' ? 'Гравець 02' : 'Гравець 01';
        checkStatusIcon(currentPlayer);
        checkStatusContainer(currentPlayer);
        statusTextInfo.textContent = "\u0422\u0412\u0406\u0419_\u0425\u0406\u0414";
        statusText.textContent = "".concat(currentPlayer);
      }, 1500);
    }
  }, 1000);
}
function minimax(board, depth, isMaximizing) {
  if (checkWinner(computerPlayer)) return 10 - depth;
  if (checkWinner(currentPlayer)) return depth - 10;
  if (isDraw()) return 0;
  if (isMaximizing) {
    var bestScore = -Infinity;
    for (var i = 0; i < board.length; i++) {
      if (board[i] === '') {
        board[i] = computerPlayer;
        var score = minimax(board, depth + 1, false);
        board[i] = '';
        bestScore = Math.max(score, bestScore);
      }
    }
    return bestScore;
  } else {
    var _bestScore = Infinity;
    for (var _i = 0; _i < board.length; _i++) {
      if (board[_i] === '') {
        board[_i] = currentPlayer;
        var _score = minimax(board, depth + 1, true);
        board[_i] = '';
        _bestScore = Math.min(_score, _bestScore);
      }
    }
    return _bestScore;
  }
}
function handleCellClick(e) {
  var cell = e.target;
  var index = cell.dataset.index;
  if (board[index] === '' && currentPlayer !== computerPlayer) {
    board[index] = currentPlayer;
    if (currentPlayer === "Гравець 02") {
      cell.classList.add('O-player');
    }
    if (currentPlayer === "Гравець 01") {
      cell.classList.add('X-player');
    }
    cell.classList.add('taken');
    var winningCombo = checkWinner(currentPlayer);
    if (winningCombo) {
      showWinLine(winningCombo);
      setTimeout(function () {
        statusText.textContent = "".concat(currentPlayer);
        hideAfterGame("win");
        endGame();
      }, 1000);
    } else if (isDraw()) {
      setTimeout(function () {
        hideAfterGame("draw");
        statusText.textContent = "Нічия!";
      }, 1000);
    } else {
      currentPlayer = computerPlayer;
      statusText.textContent = "".concat(computerPlayer);
      setTimeout(bestMove, 500);
    }
  }
}
function hideAfterGame(winner) {
  gameContainer.style.opacity = "0";
  gameGrid.style.opacity = "0";
  statusBox.classList.remove("O-player", "X-player");
  persLeft.style.transform = "translateX(220%)";
  persRight.style.transform = "translateX(-220%) scale(-1, 1)";
  if (winner === "lose") {
    gameOverText.textContent = "не пощастило!";
  }
  if (winner === "win") {
    gameOverText.textContent = "ти переміг!";
  }
  if (winner === "draw") {
    gameOverText.textContent = "ти був на рівні!";
  }
  setTimeout(function () {
    gameOverText.classList.remove("opacity");
    setTimeout(function () {
      if (winner === "draw") {
        showPopup("._draw");
      }
      if (winner === "win") {
        showPopup("._win");
      }
      if (winner === "lose") {
        showPopup("._lose");
      }
    }, 500);
  }, 1000);
}
function endGame() {
  cells.forEach(function (cell) {
    return cell.classList.add('taken');
  });
}
restartBtns.forEach(function (btn) {
  btn.addEventListener('click', function () {
    isComputerX = !isComputerX;
    initializeGame();
    gameOverText.textContent = "";
    gameGrid.style.opacity = "1";
    gameContainer.style.opacity = "1";
    persLeft.style.transform = "translateX(0%)";
    persRight.style.transform = "translateX(0%) scale(-1, 1)";
    sideBtns.forEach(function (btn) {
      btn.classList.remove("_active");
      startGame.classList.add("disabled");
      btn.addEventListener('click', function () {
        console.log(isComputerX);
        startGame.classList.remove("disabled");
        var side = btn.dataset.side;
        isComputerX = side !== 'X';
        sideBtns.forEach(function (item) {
          return item.classList.remove('_active');
        });
        btn.classList.add('_active');
      });
    });

    // document.body.style.overflow = "auto";
    document.querySelectorAll(".popup").forEach(function (popup) {
      if (popup.classList.contains('_start')) {
        popup.classList.remove('hide-popup');
        popup.classList.remove('hide');
        popup.style.opacity = "1";
      } else {
        popup.classList.add('hide-popup');
      }
    });
  });
});
cells.forEach(function (cell) {
  return cell.addEventListener('click', handleCellClick);
});
sideBtns.forEach(function (btn) {
  btn.addEventListener('click', function () {
    var side = btn.dataset.side;
    isComputerX = side !== 'X';
    sideBtns.forEach(function (item) {
      return item.classList.remove('_active');
    });
    btn.classList.add('_active');
  });
});
startGame.addEventListener('click', function () {
  document.getElementById('side-selection').style.opacity = '0';
  gameContainer.style.opacity = '1';
  landWrapper.classList.add("_decor");
  document.body.style.overflow = "auto";
  setTimeout(function () {
    enableMouseScale(document.querySelector('.decor'));
  }, 2500);
  initializeGame();
  hidePopup("#side-selection");
});
function showPopup(popup) {
  setTimeout(function () {
    popup = overlay.querySelector(popup);
    overlay.classList.remove("opacity");
    document.body.style.overflow = "hidden";
    setTimeout(function () {
      popup.classList.remove("hide-popup");
    }, 500);
  }, 2000);
}
function hidePopup(popup) {
  popup = overlay.querySelector(popup);
  overlay.classList.add("opacity");
  popup.classList.add("hide");
}
function enableMouseScale(element) {
  var minScale = 1;
  var maxScale = 1.05;
  element.style.transition = 'transform 0.1s ease';
  document.addEventListener('mousemove', function (e) {
    var rect = element.getBoundingClientRect();
    var x = e.clientX - rect.left;
    var y = e.clientY - rect.top;
    var centerX = rect.width / 2;
    var centerY = rect.height / 2;
    var distance = Math.hypot(x - centerX, y - centerY);
    var maxDistance = Math.hypot(centerX, centerY);
    var scale = minScale + (1 - distance / maxDistance) * (maxScale - minScale);
    element.style.transform = "scale(".concat(Math.min(maxScale, Math.max(minScale, scale)), ")");
  });
  element.addEventListener('mouseleave', function () {
    element.style.transform = "scale(".concat(minScale, ")");
  });
}
function showWinLine(combo) {
  var line = document.querySelector('.win-line');
  line.style.transform = 'scaleX(0)';
  // line.style.width = '100%';
  // line.style.height = '44px';
  // line.style.background = '#00f0ff';

  var positions = {
    '0,1,2': {
      top: '26%',
      left: '50%',
      rotate: '0deg',
      width: '80%'
    },
    '3,4,5': {
      top: '50%',
      left: '50%',
      rotate: '0deg',
      width: '80%'
    },
    '6,7,8': {
      top: '78.33%',
      left: '50%',
      rotate: '0deg',
      width: '80%'
    },
    '0,3,6': {
      top: '50%',
      left: '24.5%',
      rotate: '90deg',
      width: '80%'
    },
    '1,4,7': {
      top: '50%',
      left: '50%',
      rotate: '90deg',
      width: '80%'
    },
    '2,5,8': {
      top: '50%',
      left: '76.5%',
      rotate: '90deg',
      width: '80%'
    },
    '0,4,8': {
      top: '50%',
      left: '50%',
      rotate: '45deg',
      width: '100%'
    },
    '2,4,6': {
      top: '50%',
      left: '50%',
      rotate: '-45deg',
      width: '100%'
    }
  };
  var key = combo.sort(function (a, b) {
    return a - b;
  }).join(',');
  console.log(key);
  var pos = positions[key];
  console.log(pos.width);
  var width = pos.width;
  if (pos) {
    line.style.top = pos.top;
    line.style.left = pos.left;
    line.style.transform = "translate(-50%, -50%) rotate(".concat(pos.rotate, ") scaleX(1)");
    line.style.width = "".concat(pos.width);
    line.style.opacity = "1";
  }
}

// test
var testPopupButtons = document.querySelectorAll('.test-popup');
testPopupButtons.forEach(function (button) {
  button.addEventListener('click', function () {
    var popupClass = button.dataset.popup;
    var popup = overlay.querySelector(popupClass);
    var allPopups = overlay.querySelectorAll('.popup');
    var isAlreadyOpen = !popup.classList.contains('hide-popup');
    if (isAlreadyOpen) {
      overlay.classList.add('opacity');
      popup.classList.add('hide-popup');
    } else {
      allPopups.forEach(function (p) {
        return p.classList.add('hide-popup');
      });
      overlay.classList.remove('opacity');
      popup.classList.remove('hide-popup');
    }
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiY2VsbHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzdGF0dXNUZXh0IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdGF0dXNUZXh0SW5mbyIsInN0YXR1c0NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzdGF0dXNCb3giLCJyZXN0YXJ0QnRucyIsIm92ZXJsYXkiLCJzaWRlQnRucyIsInN0YXJ0R2FtZSIsImdhbWVDb250YWluZXIiLCJsYW5kV3JhcHBlciIsInN0YXR1c0ljb25YIiwic3RhdHVzSWNvbk8iLCJnYW1lR3JpZCIsInBlcnNMZWZ0IiwicGVyc1JpZ2h0IiwiZ2FtZU92ZXJUZXh0IiwiYm9hcmQiLCJpc0NvbXB1dGVyWCIsImN1cnJlbnRQbGF5ZXIiLCJjb21wdXRlclBsYXllciIsImJvZHkiLCJzdHlsZSIsIm92ZXJmbG93IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwid2lubmluZ0NvbWJvcyIsImluaXRpYWxpemVHYW1lIiwiZm9yRWFjaCIsImNlbGwiLCJ0ZXh0Q29udGVudCIsImxpbmUiLCJ0cmFuc2Zvcm0iLCJjaGVja1N0YXR1c0ljb24iLCJjaGVja1N0YXR1c0NvbnRhaW5lciIsInNldFRpbWVvdXQiLCJiZXN0TW92ZSIsInBsYXllciIsImNoZWNrV2lubmVyIiwiY29tYm8iLCJldmVyeSIsImluZGV4IiwiaXNEcmF3IiwiYmVzdFNjb3JlIiwiSW5maW5pdHkiLCJtb3ZlIiwiaSIsImxlbmd0aCIsInNjb3JlIiwibWluaW1heCIsIndpbm5pbmdDb21ibyIsInNob3dXaW5MaW5lIiwiaGlkZUFmdGVyR2FtZSIsImVuZEdhbWUiLCJkZXB0aCIsImlzTWF4aW1pemluZyIsIk1hdGgiLCJtYXgiLCJtaW4iLCJoYW5kbGVDZWxsQ2xpY2siLCJlIiwidGFyZ2V0IiwiZGF0YXNldCIsIndpbm5lciIsIm9wYWNpdHkiLCJzaG93UG9wdXAiLCJidG4iLCJhZGRFdmVudExpc3RlbmVyIiwiY29uc29sZSIsImxvZyIsInNpZGUiLCJpdGVtIiwicG9wdXAiLCJjb250YWlucyIsImVuYWJsZU1vdXNlU2NhbGUiLCJoaWRlUG9wdXAiLCJlbGVtZW50IiwibWluU2NhbGUiLCJtYXhTY2FsZSIsInRyYW5zaXRpb24iLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsImNsaWVudFgiLCJsZWZ0IiwieSIsImNsaWVudFkiLCJ0b3AiLCJjZW50ZXJYIiwid2lkdGgiLCJjZW50ZXJZIiwiaGVpZ2h0IiwiZGlzdGFuY2UiLCJoeXBvdCIsIm1heERpc3RhbmNlIiwic2NhbGUiLCJwb3NpdGlvbnMiLCJyb3RhdGUiLCJrZXkiLCJzb3J0IiwiYSIsImIiLCJqb2luIiwicG9zIiwidGVzdFBvcHVwQnV0dG9ucyIsImJ1dHRvbiIsInBvcHVwQ2xhc3MiLCJhbGxQb3B1cHMiLCJpc0FscmVhZHlPcGVuIiwicCJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxJQUFNQSxLQUFLLEdBQUdDLFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMsT0FBTyxDQUFDO0FBQ2hELElBQU1DLFVBQVUsR0FBR0YsUUFBUSxDQUFDRyxjQUFjLENBQUMsUUFBUSxDQUFDO0FBQ3BELElBQU1DLGNBQWMsR0FBR0osUUFBUSxDQUFDRyxjQUFjLENBQUMsYUFBYSxDQUFDO0FBQzdELElBQU1FLGVBQWUsR0FBR0wsUUFBUSxDQUFDTSxhQUFhLENBQUMsYUFBYSxDQUFDO0FBQzdELElBQU1DLFNBQVMsR0FBR1AsUUFBUSxDQUFDTSxhQUFhLENBQUMsZUFBZSxDQUFDO0FBQ3pELElBQU1FLFdBQVcsR0FBR1IsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxlQUFlLENBQUM7QUFDOUQsSUFBTVEsT0FBTyxHQUFHVCxRQUFRLENBQUNNLGFBQWEsQ0FBQyxVQUFVLENBQUM7QUFDbEQsSUFBTUksUUFBUSxHQUFHVixRQUFRLENBQUNDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQztBQUN2RCxJQUFNVSxTQUFTLEdBQUdYLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLGFBQWEsQ0FBQztBQUN2RCxJQUFNTSxhQUFhLEdBQUdaLFFBQVEsQ0FBQ0csY0FBYyxDQUFDLE1BQU0sQ0FBQztBQUNyRCxJQUFNVSxXQUFXLEdBQUdiLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLE9BQU8sQ0FBQztBQUNuRCxJQUFNUSxXQUFXLEdBQUdkLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLG1CQUFtQixDQUFDO0FBQy9ELElBQU1TLFdBQVcsR0FBR2YsUUFBUSxDQUFDTSxhQUFhLENBQUMsbUJBQW1CLENBQUM7QUFDL0QsSUFBTVUsUUFBUSxHQUFHaEIsUUFBUSxDQUFDTSxhQUFhLENBQUMsWUFBWSxDQUFDO0FBQ3JELElBQU1XLFFBQVEsR0FBR2pCLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLGtCQUFrQixDQUFDO0FBQzNELElBQU1ZLFNBQVMsR0FBR2xCLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLG1CQUFtQixDQUFDO0FBQzdELElBQU1hLFlBQVksR0FBR25CLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLFlBQVksQ0FBQztBQUV6RCxJQUFJYyxLQUFLLEdBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztBQUNoRCxJQUFJQyxXQUFXLEdBQUcsSUFBSTtBQUN0QixJQUFJQyxhQUFhLEVBQUVDLGNBQWM7QUFFakN2QixRQUFRLENBQUN3QixJQUFJLENBQUNDLEtBQUssQ0FBQ0MsUUFBUSxHQUFHLFFBQVE7QUFFdkMsSUFBSUwsV0FBVyxFQUFFO0VBQ2JyQixRQUFRLENBQUNNLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDcUIsU0FBUyxDQUFDQyxNQUFNLENBQUMsU0FBUyxDQUFDO0VBQ3JFNUIsUUFBUSxDQUFDTSxhQUFhLENBQUMsaUJBQWlCLENBQUMsQ0FBQ3FCLFNBQVMsQ0FBQ0UsR0FBRyxDQUFDLFNBQVMsQ0FBQztBQUN0RSxDQUFDLE1BQU07RUFDSDdCLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLGlCQUFpQixDQUFDLENBQUNxQixTQUFTLENBQUNDLE1BQU0sQ0FBQyxTQUFTLENBQUM7RUFDckU1QixRQUFRLENBQUNNLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDcUIsU0FBUyxDQUFDRSxHQUFHLENBQUMsU0FBUyxDQUFDO0FBQ3RFO0FBRUEsSUFBTUMsYUFBYSxHQUFHLENBQ2xCLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDVCxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQ1QsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUNULENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDVCxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQ1QsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUNULENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDVCxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQ1o7QUFFRCxTQUFTQyxjQUFjLEdBQUc7RUFDdEJULGFBQWEsR0FBR0QsV0FBVyxHQUFHLFlBQVksR0FBRyxZQUFZO0VBQ3pERSxjQUFjLEdBQUdGLFdBQVcsR0FBRyxZQUFZLEdBQUcsWUFBWTtFQUMxREQsS0FBSyxHQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7RUFDNUNyQixLQUFLLENBQUNpQyxPQUFPLENBQUMsVUFBQUMsSUFBSSxFQUFJO0lBQ2xCQSxJQUFJLENBQUNDLFdBQVcsR0FBRyxFQUFFO0lBQ3JCRCxJQUFJLENBQUNOLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDO0VBQzFELENBQUMsQ0FBQztFQUVGLElBQU1PLElBQUksR0FBR25DLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLFdBQVcsQ0FBQztFQUNoRCxJQUFJNkIsSUFBSSxFQUFFO0lBQ05BLElBQUksQ0FBQ1YsS0FBSyxDQUFDVyxTQUFTLEdBQUcsV0FBVztFQUN0QztFQUVBQyxlQUFlLENBQUNmLGFBQWEsQ0FBQztFQUM5QmdCLG9CQUFvQixDQUFDaEIsYUFBYSxDQUFDO0VBRW5DcEIsVUFBVSxDQUFDZ0MsV0FBVyxhQUFNWixhQUFhLENBQUU7RUFDM0NsQixjQUFjLENBQUM4QixXQUFXLGdEQUFhO0VBQ3ZDLElBQUlaLGFBQWEsS0FBS0MsY0FBYyxFQUFFO0lBQ2xDZ0IsVUFBVSxDQUFDQyxRQUFRLEVBQUUsR0FBRyxDQUFDO0VBQzdCO0FBQ0o7QUFFQSxTQUFTSCxlQUFlLENBQUNJLE1BQU0sRUFBRTtFQUM3QixJQUFJQSxNQUFNLEtBQUssWUFBWSxFQUFFO0lBQ3pCM0IsV0FBVyxDQUFDYSxTQUFTLENBQUNFLEdBQUcsQ0FBQyxTQUFTLENBQUM7SUFDcENkLFdBQVcsQ0FBQ1ksU0FBUyxDQUFDQyxNQUFNLENBQUMsU0FBUyxDQUFDO0VBQzNDO0VBQ0EsSUFBSWEsTUFBTSxLQUFLLFlBQVksRUFBRTtJQUN6QjFCLFdBQVcsQ0FBQ1ksU0FBUyxDQUFDRSxHQUFHLENBQUMsU0FBUyxDQUFDO0lBQ3BDZixXQUFXLENBQUNhLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLFNBQVMsQ0FBQztFQUMzQztBQUNKO0FBRUEsU0FBU1Usb0JBQW9CLENBQUNHLE1BQU0sRUFBRTtFQUNsQyxJQUFJQSxNQUFNLEtBQUssWUFBWSxFQUFFO0lBQ3pCbEMsU0FBUyxDQUFDb0IsU0FBUyxDQUFDRSxHQUFHLENBQUMsVUFBVSxDQUFDO0lBQ25DdEIsU0FBUyxDQUFDb0IsU0FBUyxDQUFDQyxNQUFNLENBQUMsVUFBVSxDQUFDO0VBQzFDO0VBQ0EsSUFBSWEsTUFBTSxLQUFLLFlBQVksRUFBRTtJQUN6QmxDLFNBQVMsQ0FBQ29CLFNBQVMsQ0FBQ0UsR0FBRyxDQUFDLFVBQVUsQ0FBQztJQUNuQ3RCLFNBQVMsQ0FBQ29CLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLFVBQVUsQ0FBQztFQUMxQztBQUNKO0FBRUEsU0FBU2MsV0FBVyxDQUFDRCxNQUFNLEVBQUU7RUFBQSwyQ0FDTFgsYUFBYTtJQUFBO0VBQUE7SUFBakMsb0RBQW1DO01BQUEsSUFBeEJhLEtBQUs7TUFDWixJQUFJQSxLQUFLLENBQUNDLEtBQUssQ0FBQyxVQUFBQyxLQUFLO1FBQUEsT0FBSXpCLEtBQUssQ0FBQ3lCLEtBQUssQ0FBQyxLQUFLSixNQUFNO01BQUEsRUFBQyxFQUFFO1FBQy9DLE9BQU9FLEtBQUs7TUFDaEI7SUFDSjtFQUFDO0lBQUE7RUFBQTtJQUFBO0VBQUE7RUFDRCxPQUFPLElBQUk7QUFDZjtBQUVBLFNBQVNHLE1BQU0sR0FBRztFQUNkLE9BQU8xQixLQUFLLENBQUN3QixLQUFLLENBQUMsVUFBQVgsSUFBSTtJQUFBLE9BQUlBLElBQUksS0FBSyxFQUFFO0VBQUEsRUFBQztBQUMzQztBQUVBLFNBQVNPLFFBQVEsR0FBRztFQUNoQkQsVUFBVSxDQUFDLFlBQU07SUFDYixJQUFJUSxTQUFTLEdBQUcsQ0FBQ0MsUUFBUTtJQUN6QixJQUFJQyxJQUFJO0lBRVIsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUc5QixLQUFLLENBQUMrQixNQUFNLEVBQUVELENBQUMsRUFBRSxFQUFFO01BQ25DLElBQUk5QixLQUFLLENBQUM4QixDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7UUFDakI5QixLQUFLLENBQUM4QixDQUFDLENBQUMsR0FBRzNCLGNBQWM7UUFDekIsSUFBSTZCLEtBQUssR0FBR0MsT0FBTyxDQUFDakMsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLENBQUM7UUFDcENBLEtBQUssQ0FBQzhCLENBQUMsQ0FBQyxHQUFHLEVBQUU7UUFDYixJQUFJRSxLQUFLLEdBQUdMLFNBQVMsRUFBRTtVQUNuQkEsU0FBUyxHQUFHSyxLQUFLO1VBQ2pCSCxJQUFJLEdBQUdDLENBQUM7UUFDWjtNQUNKO0lBQ0o7SUFFQTlCLEtBQUssQ0FBQzZCLElBQUksQ0FBQyxHQUFHMUIsY0FBYztJQUU1QixJQUFJQSxjQUFjLEtBQUssWUFBWSxFQUFFO01BQ2pDeEIsS0FBSyxDQUFDa0QsSUFBSSxDQUFDLENBQUN0QixTQUFTLENBQUNFLEdBQUcsQ0FBQyxVQUFVLENBQUM7SUFDekM7SUFDQSxJQUFJTixjQUFjLEtBQUssWUFBWSxFQUFFO01BQ2pDeEIsS0FBSyxDQUFDa0QsSUFBSSxDQUFDLENBQUN0QixTQUFTLENBQUNFLEdBQUcsQ0FBQyxVQUFVLENBQUM7SUFDekM7SUFFQVEsZUFBZSxDQUFDZCxjQUFjLENBQUM7SUFDL0JlLG9CQUFvQixDQUFDaEIsYUFBYSxDQUFDO0lBQ25DbEIsY0FBYyxDQUFDOEIsV0FBVyxtQ0FBVTtJQUVwQ25DLEtBQUssQ0FBQ2tELElBQUksQ0FBQyxDQUFDdEIsU0FBUyxDQUFDRSxHQUFHLENBQUMsT0FBTyxDQUFDO0lBRWxDLElBQU15QixZQUFZLEdBQUdaLFdBQVcsQ0FBQ25CLGNBQWMsQ0FBQztJQUNoRCxJQUFJK0IsWUFBWSxFQUFFO01BQ2RDLFdBQVcsQ0FBQ0QsWUFBWSxDQUFDO01BQ3pCZixVQUFVLENBQUMsWUFBSztRQUNackMsVUFBVSxDQUFDZ0MsV0FBVyxhQUFNWCxjQUFjLENBQUU7UUFDNUNpQyxhQUFhLENBQUMsTUFBTSxDQUFDO1FBQ3JCQyxPQUFPLEVBQUU7TUFDYixDQUFDLEVBQUUsSUFBSSxDQUFDO0lBQ1osQ0FBQyxNQUFNLElBQUlYLE1BQU0sRUFBRSxFQUFFO01BQ2pCVSxhQUFhLENBQUMsTUFBTSxDQUFDO01BQ3JCdEQsVUFBVSxDQUFDZ0MsV0FBVyxHQUFHLFFBQVE7SUFDckMsQ0FBQyxNQUFNO01BQ0hLLFVBQVUsQ0FBQyxZQUFNO1FBQ2JqQixhQUFhLEdBQUdBLGFBQWEsS0FBSyxZQUFZLEdBQUcsWUFBWSxHQUFHLFlBQVk7UUFDNUVlLGVBQWUsQ0FBQ2YsYUFBYSxDQUFDO1FBQzlCZ0Isb0JBQW9CLENBQUNoQixhQUFhLENBQUM7UUFDbkNsQixjQUFjLENBQUM4QixXQUFXLGdEQUFhO1FBQ3ZDaEMsVUFBVSxDQUFDZ0MsV0FBVyxhQUFNWixhQUFhLENBQUU7TUFDL0MsQ0FBQyxFQUFFLElBQUksQ0FBQztJQUNaO0VBQ0osQ0FBQyxFQUFFLElBQUksQ0FBQztBQUNaO0FBRUEsU0FBUytCLE9BQU8sQ0FBQ2pDLEtBQUssRUFBRXNDLEtBQUssRUFBRUMsWUFBWSxFQUFFO0VBQ3pDLElBQUlqQixXQUFXLENBQUNuQixjQUFjLENBQUMsRUFBRSxPQUFPLEVBQUUsR0FBR21DLEtBQUs7RUFDbEQsSUFBSWhCLFdBQVcsQ0FBQ3BCLGFBQWEsQ0FBQyxFQUFFLE9BQU9vQyxLQUFLLEdBQUcsRUFBRTtFQUNqRCxJQUFJWixNQUFNLEVBQUUsRUFBRSxPQUFPLENBQUM7RUFFdEIsSUFBSWEsWUFBWSxFQUFFO0lBQ2QsSUFBSVosU0FBUyxHQUFHLENBQUNDLFFBQVE7SUFDekIsS0FBSyxJQUFJRSxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUc5QixLQUFLLENBQUMrQixNQUFNLEVBQUVELENBQUMsRUFBRSxFQUFFO01BQ25DLElBQUk5QixLQUFLLENBQUM4QixDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7UUFDakI5QixLQUFLLENBQUM4QixDQUFDLENBQUMsR0FBRzNCLGNBQWM7UUFDekIsSUFBSTZCLEtBQUssR0FBR0MsT0FBTyxDQUFDakMsS0FBSyxFQUFFc0MsS0FBSyxHQUFHLENBQUMsRUFBRSxLQUFLLENBQUM7UUFDNUN0QyxLQUFLLENBQUM4QixDQUFDLENBQUMsR0FBRyxFQUFFO1FBQ2JILFNBQVMsR0FBR2EsSUFBSSxDQUFDQyxHQUFHLENBQUNULEtBQUssRUFBRUwsU0FBUyxDQUFDO01BQzFDO0lBQ0o7SUFDQSxPQUFPQSxTQUFTO0VBQ3BCLENBQUMsTUFBTTtJQUNILElBQUlBLFVBQVMsR0FBR0MsUUFBUTtJQUN4QixLQUFLLElBQUlFLEVBQUMsR0FBRyxDQUFDLEVBQUVBLEVBQUMsR0FBRzlCLEtBQUssQ0FBQytCLE1BQU0sRUFBRUQsRUFBQyxFQUFFLEVBQUU7TUFDbkMsSUFBSTlCLEtBQUssQ0FBQzhCLEVBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTtRQUNqQjlCLEtBQUssQ0FBQzhCLEVBQUMsQ0FBQyxHQUFHNUIsYUFBYTtRQUN4QixJQUFJOEIsTUFBSyxHQUFHQyxPQUFPLENBQUNqQyxLQUFLLEVBQUVzQyxLQUFLLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQztRQUMzQ3RDLEtBQUssQ0FBQzhCLEVBQUMsQ0FBQyxHQUFHLEVBQUU7UUFDYkgsVUFBUyxHQUFHYSxJQUFJLENBQUNFLEdBQUcsQ0FBQ1YsTUFBSyxFQUFFTCxVQUFTLENBQUM7TUFDMUM7SUFDSjtJQUNBLE9BQU9BLFVBQVM7RUFDcEI7QUFDSjtBQUVBLFNBQVNnQixlQUFlLENBQUNDLENBQUMsRUFBRTtFQUN4QixJQUFNL0IsSUFBSSxHQUFHK0IsQ0FBQyxDQUFDQyxNQUFNO0VBQ3JCLElBQU1wQixLQUFLLEdBQUdaLElBQUksQ0FBQ2lDLE9BQU8sQ0FBQ3JCLEtBQUs7RUFFaEMsSUFBSXpCLEtBQUssQ0FBQ3lCLEtBQUssQ0FBQyxLQUFLLEVBQUUsSUFBSXZCLGFBQWEsS0FBS0MsY0FBYyxFQUFFO0lBQ3pESCxLQUFLLENBQUN5QixLQUFLLENBQUMsR0FBR3ZCLGFBQWE7SUFFNUIsSUFBSUEsYUFBYSxLQUFLLFlBQVksRUFBRTtNQUNoQ1csSUFBSSxDQUFDTixTQUFTLENBQUNFLEdBQUcsQ0FBQyxVQUFVLENBQUM7SUFDbEM7SUFDQSxJQUFJUCxhQUFhLEtBQUssWUFBWSxFQUFFO01BQ2hDVyxJQUFJLENBQUNOLFNBQVMsQ0FBQ0UsR0FBRyxDQUFDLFVBQVUsQ0FBQztJQUNsQztJQUVBSSxJQUFJLENBQUNOLFNBQVMsQ0FBQ0UsR0FBRyxDQUFDLE9BQU8sQ0FBQztJQUUzQixJQUFNeUIsWUFBWSxHQUFHWixXQUFXLENBQUNwQixhQUFhLENBQUM7SUFDL0MsSUFBSWdDLFlBQVksRUFBRTtNQUNkQyxXQUFXLENBQUNELFlBQVksQ0FBQztNQUN6QmYsVUFBVSxDQUFDLFlBQU07UUFDYnJDLFVBQVUsQ0FBQ2dDLFdBQVcsYUFBTVosYUFBYSxDQUFFO1FBQzNDa0MsYUFBYSxDQUFDLEtBQUssQ0FBQztRQUNwQkMsT0FBTyxFQUFFO01BQ2IsQ0FBQyxFQUFFLElBQUksQ0FBQztJQUNaLENBQUMsTUFBTSxJQUFJWCxNQUFNLEVBQUUsRUFBRTtNQUNqQlAsVUFBVSxDQUFDLFlBQU07UUFDYmlCLGFBQWEsQ0FBQyxNQUFNLENBQUM7UUFDckJ0RCxVQUFVLENBQUNnQyxXQUFXLEdBQUcsUUFBUTtNQUNyQyxDQUFDLEVBQUUsSUFBSSxDQUFDO0lBQ1osQ0FBQyxNQUFNO01BQ0haLGFBQWEsR0FBR0MsY0FBYztNQUM5QnJCLFVBQVUsQ0FBQ2dDLFdBQVcsYUFBTVgsY0FBYyxDQUFFO01BQzVDZ0IsVUFBVSxDQUFDQyxRQUFRLEVBQUUsR0FBRyxDQUFDO0lBQzdCO0VBQ0o7QUFDSjtBQUVBLFNBQVNnQixhQUFhLENBQUNXLE1BQU0sRUFBQztFQUMxQnZELGFBQWEsQ0FBQ2EsS0FBSyxDQUFDMkMsT0FBTyxHQUFHLEdBQUc7RUFDakNwRCxRQUFRLENBQUNTLEtBQUssQ0FBQzJDLE9BQU8sR0FBRyxHQUFHO0VBQzVCN0QsU0FBUyxDQUFDb0IsU0FBUyxDQUFDQyxNQUFNLENBQUMsVUFBVSxFQUFFLFVBQVUsQ0FBQztFQUNsRFgsUUFBUSxDQUFDUSxLQUFLLENBQUNXLFNBQVMsR0FBRyxrQkFBa0I7RUFDN0NsQixTQUFTLENBQUNPLEtBQUssQ0FBQ1csU0FBUyxHQUFHLGdDQUFnQztFQUk1RCxJQUFHK0IsTUFBTSxLQUFLLE1BQU0sRUFBQztJQUNqQmhELFlBQVksQ0FBQ2UsV0FBVyxHQUFHLGVBQWU7RUFDOUM7RUFDQSxJQUFHaUMsTUFBTSxLQUFLLEtBQUssRUFBQztJQUNoQmhELFlBQVksQ0FBQ2UsV0FBVyxHQUFHLGFBQWE7RUFDNUM7RUFDQSxJQUFHaUMsTUFBTSxLQUFLLE1BQU0sRUFBQztJQUNqQmhELFlBQVksQ0FBQ2UsV0FBVyxHQUFHLGtCQUFrQjtFQUNqRDtFQUVBSyxVQUFVLENBQUMsWUFBSztJQUNacEIsWUFBWSxDQUFDUSxTQUFTLENBQUNDLE1BQU0sQ0FBQyxTQUFTLENBQUM7SUFDeENXLFVBQVUsQ0FBQyxZQUFLO01BQ1osSUFBRzRCLE1BQU0sS0FBSyxNQUFNLEVBQUM7UUFDakJFLFNBQVMsQ0FBQyxRQUFRLENBQUM7TUFDdkI7TUFDQSxJQUFHRixNQUFNLEtBQUssS0FBSyxFQUFDO1FBQ2hCRSxTQUFTLENBQUMsT0FBTyxDQUFDO01BQ3RCO01BQ0EsSUFBR0YsTUFBTSxLQUFLLE1BQU0sRUFBQztRQUNqQkUsU0FBUyxDQUFDLFFBQVEsQ0FBQztNQUN2QjtJQUNKLENBQUMsRUFBRSxHQUFHLENBQUM7RUFFWCxDQUFDLEVBQUUsSUFBSSxDQUFDO0FBRVo7QUFFQSxTQUFTWixPQUFPLEdBQUc7RUFDZjFELEtBQUssQ0FBQ2lDLE9BQU8sQ0FBQyxVQUFBQyxJQUFJO0lBQUEsT0FBSUEsSUFBSSxDQUFDTixTQUFTLENBQUNFLEdBQUcsQ0FBQyxPQUFPLENBQUM7RUFBQSxFQUFDO0FBQ3REO0FBRUFyQixXQUFXLENBQUN3QixPQUFPLENBQUMsVUFBQXNDLEdBQUcsRUFBRztFQUN0QkEsR0FBRyxDQUFDQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBTTtJQUM1QmxELFdBQVcsR0FBRyxDQUFDQSxXQUFXO0lBQzFCVSxjQUFjLEVBQUU7SUFDaEJaLFlBQVksQ0FBQ2UsV0FBVyxLQUFLO0lBQzdCbEIsUUFBUSxDQUFDUyxLQUFLLENBQUMyQyxPQUFPLEdBQUcsR0FBRztJQUM1QnhELGFBQWEsQ0FBQ2EsS0FBSyxDQUFDMkMsT0FBTyxHQUFHLEdBQUc7SUFDakNuRCxRQUFRLENBQUNRLEtBQUssQ0FBQ1csU0FBUyxHQUFHLGdCQUFnQjtJQUMzQ2xCLFNBQVMsQ0FBQ08sS0FBSyxDQUFDVyxTQUFTLEdBQUcsNkJBQTZCO0lBQ3pEMUIsUUFBUSxDQUFDc0IsT0FBTyxDQUFDLFVBQUFzQyxHQUFHLEVBQUk7TUFDcEJBLEdBQUcsQ0FBQzNDLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLFNBQVMsQ0FBQztNQUMvQmpCLFNBQVMsQ0FBQ2dCLFNBQVMsQ0FBQ0UsR0FBRyxDQUFDLFVBQVUsQ0FBQztNQUNuQ3lDLEdBQUcsQ0FBQ0MsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFlBQU07UUFDaENDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDcEQsV0FBVyxDQUFDO1FBQ3hCVixTQUFTLENBQUNnQixTQUFTLENBQUNDLE1BQU0sQ0FBQyxVQUFVLENBQUM7UUFDdEMsSUFBTThDLElBQUksR0FBR0osR0FBRyxDQUFDSixPQUFPLENBQUNRLElBQUk7UUFDN0JyRCxXQUFXLEdBQUdxRCxJQUFJLEtBQUssR0FBRztRQUMxQmhFLFFBQVEsQ0FBQ3NCLE9BQU8sQ0FBQyxVQUFBMkMsSUFBSTtVQUFBLE9BQUlBLElBQUksQ0FBQ2hELFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLFNBQVMsQ0FBQztRQUFBLEVBQUM7UUFDMUQwQyxHQUFHLENBQUMzQyxTQUFTLENBQUNFLEdBQUcsQ0FBQyxTQUFTLENBQUM7TUFDaEMsQ0FBQyxDQUFDO0lBQ04sQ0FBQyxDQUFDOztJQUVGO0lBQ0E3QixRQUFRLENBQUNDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDK0IsT0FBTyxDQUFDLFVBQUE0QyxLQUFLLEVBQUk7TUFDakQsSUFBR0EsS0FBSyxDQUFDakQsU0FBUyxDQUFDa0QsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFDO1FBQ2xDRCxLQUFLLENBQUNqRCxTQUFTLENBQUNDLE1BQU0sQ0FBQyxZQUFZLENBQUM7UUFDcENnRCxLQUFLLENBQUNqRCxTQUFTLENBQUNDLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDOUJnRCxLQUFLLENBQUNuRCxLQUFLLENBQUMyQyxPQUFPLEdBQUcsR0FBRztNQUM3QixDQUFDLE1BQUk7UUFDRFEsS0FBSyxDQUFDakQsU0FBUyxDQUFDRSxHQUFHLENBQUMsWUFBWSxDQUFDO01BQ3JDO0lBQ0osQ0FBQyxDQUFDO0VBQ04sQ0FBQyxDQUFDO0FBQ1YsQ0FBQyxDQUFDO0FBRUY5QixLQUFLLENBQUNpQyxPQUFPLENBQUMsVUFBQUMsSUFBSTtFQUFBLE9BQUlBLElBQUksQ0FBQ3NDLGdCQUFnQixDQUFDLE9BQU8sRUFBRVIsZUFBZSxDQUFDO0FBQUEsRUFBQztBQUV0RXJELFFBQVEsQ0FBQ3NCLE9BQU8sQ0FBQyxVQUFBc0MsR0FBRyxFQUFJO0VBQ3BCQSxHQUFHLENBQUNDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxZQUFNO0lBQ2hDLElBQU1HLElBQUksR0FBR0osR0FBRyxDQUFDSixPQUFPLENBQUNRLElBQUk7SUFDN0JyRCxXQUFXLEdBQUdxRCxJQUFJLEtBQUssR0FBRztJQUMxQmhFLFFBQVEsQ0FBQ3NCLE9BQU8sQ0FBQyxVQUFBMkMsSUFBSTtNQUFBLE9BQUlBLElBQUksQ0FBQ2hELFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLFNBQVMsQ0FBQztJQUFBLEVBQUM7SUFDMUQwQyxHQUFHLENBQUMzQyxTQUFTLENBQUNFLEdBQUcsQ0FBQyxTQUFTLENBQUM7RUFDaEMsQ0FBQyxDQUFDO0FBQ04sQ0FBQyxDQUFDO0FBRUZsQixTQUFTLENBQUM0RCxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBTTtFQUN0Q3ZFLFFBQVEsQ0FBQ0csY0FBYyxDQUFDLGdCQUFnQixDQUFDLENBQUNzQixLQUFLLENBQUMyQyxPQUFPLEdBQUcsR0FBRztFQUM3RHhELGFBQWEsQ0FBQ2EsS0FBSyxDQUFDMkMsT0FBTyxHQUFHLEdBQUc7RUFDakN2RCxXQUFXLENBQUNjLFNBQVMsQ0FBQ0UsR0FBRyxDQUFDLFFBQVEsQ0FBQztFQUNuQzdCLFFBQVEsQ0FBQ3dCLElBQUksQ0FBQ0MsS0FBSyxDQUFDQyxRQUFRLEdBQUcsTUFBTTtFQUNyQ2EsVUFBVSxDQUFDLFlBQU07SUFDYnVDLGdCQUFnQixDQUFDOUUsUUFBUSxDQUFDTSxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7RUFDdEQsQ0FBQyxFQUFFLElBQUksQ0FBQztFQUNSeUIsY0FBYyxFQUFFO0VBQ2hCZ0QsU0FBUyxDQUFDLGlCQUFpQixDQUFDO0FBQ2hDLENBQUMsQ0FBQztBQUVGLFNBQVNWLFNBQVMsQ0FBQ08sS0FBSyxFQUFFO0VBRXRCckMsVUFBVSxDQUFDLFlBQU07SUFDYnFDLEtBQUssR0FBR25FLE9BQU8sQ0FBQ0gsYUFBYSxDQUFDc0UsS0FBSyxDQUFDO0lBQ3BDbkUsT0FBTyxDQUFDa0IsU0FBUyxDQUFDQyxNQUFNLENBQUMsU0FBUyxDQUFDO0lBQ25DNUIsUUFBUSxDQUFDd0IsSUFBSSxDQUFDQyxLQUFLLENBQUNDLFFBQVEsR0FBRyxRQUFRO0lBQ3ZDYSxVQUFVLENBQUMsWUFBSztNQUNacUMsS0FBSyxDQUFDakQsU0FBUyxDQUFDQyxNQUFNLENBQUMsWUFBWSxDQUFDO0lBQ3hDLENBQUMsRUFBRSxHQUFHLENBQUM7RUFDWCxDQUFDLEVBQUUsSUFBSSxDQUFDO0FBRVo7QUFFQSxTQUFTbUQsU0FBUyxDQUFDSCxLQUFLLEVBQUU7RUFDdEJBLEtBQUssR0FBR25FLE9BQU8sQ0FBQ0gsYUFBYSxDQUFDc0UsS0FBSyxDQUFDO0VBQ3BDbkUsT0FBTyxDQUFDa0IsU0FBUyxDQUFDRSxHQUFHLENBQUMsU0FBUyxDQUFDO0VBQ2hDK0MsS0FBSyxDQUFDakQsU0FBUyxDQUFDRSxHQUFHLENBQUMsTUFBTSxDQUFDO0FBQy9CO0FBRUEsU0FBU2lELGdCQUFnQixDQUFDRSxPQUFPLEVBQUU7RUFDL0IsSUFBTUMsUUFBUSxHQUFHLENBQUM7RUFDbEIsSUFBTUMsUUFBUSxHQUFHLElBQUk7RUFDckJGLE9BQU8sQ0FBQ3ZELEtBQUssQ0FBQzBELFVBQVUsR0FBRyxxQkFBcUI7RUFFaERuRixRQUFRLENBQUN1RSxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsVUFBQ1AsQ0FBQyxFQUFLO0lBQzFDLElBQU1vQixJQUFJLEdBQUdKLE9BQU8sQ0FBQ0sscUJBQXFCLEVBQUU7SUFDNUMsSUFBTUMsQ0FBQyxHQUFHdEIsQ0FBQyxDQUFDdUIsT0FBTyxHQUFHSCxJQUFJLENBQUNJLElBQUk7SUFDL0IsSUFBTUMsQ0FBQyxHQUFHekIsQ0FBQyxDQUFDMEIsT0FBTyxHQUFHTixJQUFJLENBQUNPLEdBQUc7SUFDOUIsSUFBTUMsT0FBTyxHQUFHUixJQUFJLENBQUNTLEtBQUssR0FBRyxDQUFDO0lBQzlCLElBQU1DLE9BQU8sR0FBR1YsSUFBSSxDQUFDVyxNQUFNLEdBQUcsQ0FBQztJQUMvQixJQUFNQyxRQUFRLEdBQUdwQyxJQUFJLENBQUNxQyxLQUFLLENBQUNYLENBQUMsR0FBR00sT0FBTyxFQUFFSCxDQUFDLEdBQUdLLE9BQU8sQ0FBQztJQUNyRCxJQUFNSSxXQUFXLEdBQUd0QyxJQUFJLENBQUNxQyxLQUFLLENBQUNMLE9BQU8sRUFBRUUsT0FBTyxDQUFDO0lBQ2hELElBQU1LLEtBQUssR0FBR2xCLFFBQVEsR0FBRyxDQUFDLENBQUMsR0FBR2UsUUFBUSxHQUFHRSxXQUFXLEtBQUtoQixRQUFRLEdBQUdELFFBQVEsQ0FBQztJQUM3RUQsT0FBTyxDQUFDdkQsS0FBSyxDQUFDVyxTQUFTLG1CQUFZd0IsSUFBSSxDQUFDRSxHQUFHLENBQUNvQixRQUFRLEVBQUV0QixJQUFJLENBQUNDLEdBQUcsQ0FBQ29CLFFBQVEsRUFBRWtCLEtBQUssQ0FBQyxDQUFDLE1BQUc7RUFDdkYsQ0FBQyxDQUFDO0VBRUZuQixPQUFPLENBQUNULGdCQUFnQixDQUFDLFlBQVksRUFBRSxZQUFNO0lBQ3pDUyxPQUFPLENBQUN2RCxLQUFLLENBQUNXLFNBQVMsbUJBQVk2QyxRQUFRLE1BQUc7RUFDbEQsQ0FBQyxDQUFDO0FBQ047QUFFQSxTQUFTMUIsV0FBVyxDQUFDWixLQUFLLEVBQUU7RUFDeEIsSUFBTVIsSUFBSSxHQUFHbkMsUUFBUSxDQUFDTSxhQUFhLENBQUMsV0FBVyxDQUFDO0VBQ2hENkIsSUFBSSxDQUFDVixLQUFLLENBQUNXLFNBQVMsR0FBRyxXQUFXO0VBQ2xDO0VBQ0E7RUFDQTs7RUFFQSxJQUFNZ0UsU0FBUyxHQUFHO0lBQ2QsT0FBTyxFQUFFO01BQUVULEdBQUcsRUFBRSxLQUFLO01BQUVILElBQUksRUFBRSxLQUFLO01BQUVhLE1BQU0sRUFBRSxNQUFNO01BQUVSLEtBQUssRUFBRTtJQUFNLENBQUM7SUFDbEUsT0FBTyxFQUFFO01BQUVGLEdBQUcsRUFBRSxLQUFLO01BQUVILElBQUksRUFBRSxLQUFLO01BQUVhLE1BQU0sRUFBRSxNQUFNO01BQUVSLEtBQUssRUFBRTtJQUFNLENBQUM7SUFDbEUsT0FBTyxFQUFFO01BQUVGLEdBQUcsRUFBRSxRQUFRO01BQUVILElBQUksRUFBRSxLQUFLO01BQUVhLE1BQU0sRUFBRSxNQUFNO01BQUVSLEtBQUssRUFBRTtJQUFNLENBQUM7SUFDckUsT0FBTyxFQUFFO01BQUVGLEdBQUcsRUFBRSxLQUFLO01BQUVILElBQUksRUFBRSxPQUFPO01BQUVhLE1BQU0sRUFBRSxPQUFPO01BQUVSLEtBQUssRUFBRTtJQUFLLENBQUM7SUFDcEUsT0FBTyxFQUFFO01BQUVGLEdBQUcsRUFBRSxLQUFLO01BQUVILElBQUksRUFBRSxLQUFLO01BQUVhLE1BQU0sRUFBRSxPQUFPO01BQUVSLEtBQUssRUFBRTtJQUFNLENBQUM7SUFDbkUsT0FBTyxFQUFFO01BQUVGLEdBQUcsRUFBRSxLQUFLO01BQUVILElBQUksRUFBRSxPQUFPO01BQUVhLE1BQU0sRUFBRSxPQUFPO01BQUVSLEtBQUssRUFBRTtJQUFNLENBQUM7SUFDckUsT0FBTyxFQUFFO01BQUVGLEdBQUcsRUFBRSxLQUFLO01BQUVILElBQUksRUFBRSxLQUFLO01BQUVhLE1BQU0sRUFBRSxPQUFPO01BQUVSLEtBQUssRUFBRTtJQUFPLENBQUM7SUFDcEUsT0FBTyxFQUFFO01BQUVGLEdBQUcsRUFBRSxLQUFLO01BQUVILElBQUksRUFBRSxLQUFLO01BQUVhLE1BQU0sRUFBRSxRQUFRO01BQUVSLEtBQUssRUFBRTtJQUFPO0VBQ3hFLENBQUM7RUFFRCxJQUFNUyxHQUFHLEdBQUczRCxLQUFLLENBQUM0RCxJQUFJLENBQUMsVUFBQ0MsQ0FBQyxFQUFFQyxDQUFDO0lBQUEsT0FBS0QsQ0FBQyxHQUFHQyxDQUFDO0VBQUEsRUFBQyxDQUFDQyxJQUFJLENBQUMsR0FBRyxDQUFDO0VBRWpEbEMsT0FBTyxDQUFDQyxHQUFHLENBQUM2QixHQUFHLENBQUM7RUFFaEIsSUFBTUssR0FBRyxHQUFHUCxTQUFTLENBQUNFLEdBQUcsQ0FBQztFQUUxQjlCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDa0MsR0FBRyxDQUFDZCxLQUFLLENBQUM7RUFFdEIsSUFBSUEsS0FBSyxHQUFHYyxHQUFHLENBQUNkLEtBQUs7RUFFckIsSUFBSWMsR0FBRyxFQUFFO0lBQ0x4RSxJQUFJLENBQUNWLEtBQUssQ0FBQ2tFLEdBQUcsR0FBR2dCLEdBQUcsQ0FBQ2hCLEdBQUc7SUFDeEJ4RCxJQUFJLENBQUNWLEtBQUssQ0FBQytELElBQUksR0FBR21CLEdBQUcsQ0FBQ25CLElBQUk7SUFDMUJyRCxJQUFJLENBQUNWLEtBQUssQ0FBQ1csU0FBUywwQ0FBbUN1RSxHQUFHLENBQUNOLE1BQU0sZ0JBQWE7SUFDOUVsRSxJQUFJLENBQUNWLEtBQUssQ0FBQ29FLEtBQUssYUFBTWMsR0FBRyxDQUFDZCxLQUFLLENBQUU7SUFDakMxRCxJQUFJLENBQUNWLEtBQUssQ0FBQzJDLE9BQU8sTUFBTTtFQUM1QjtBQUNKOztBQUVBO0FBQ0EsSUFBTXdDLGdCQUFnQixHQUFHNUcsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUM7QUFDakUyRyxnQkFBZ0IsQ0FBQzVFLE9BQU8sQ0FBQyxVQUFBNkUsTUFBTSxFQUFJO0VBQy9CQSxNQUFNLENBQUN0QyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBTTtJQUNuQyxJQUFNdUMsVUFBVSxHQUFHRCxNQUFNLENBQUMzQyxPQUFPLENBQUNVLEtBQUs7SUFDdkMsSUFBTUEsS0FBSyxHQUFHbkUsT0FBTyxDQUFDSCxhQUFhLENBQUN3RyxVQUFVLENBQUM7SUFDL0MsSUFBTUMsU0FBUyxHQUFHdEcsT0FBTyxDQUFDUixnQkFBZ0IsQ0FBQyxRQUFRLENBQUM7SUFDcEQsSUFBTStHLGFBQWEsR0FBRyxDQUFDcEMsS0FBSyxDQUFDakQsU0FBUyxDQUFDa0QsUUFBUSxDQUFDLFlBQVksQ0FBQztJQUU3RCxJQUFJbUMsYUFBYSxFQUFFO01BQ2Z2RyxPQUFPLENBQUNrQixTQUFTLENBQUNFLEdBQUcsQ0FBQyxTQUFTLENBQUM7TUFDaEMrQyxLQUFLLENBQUNqRCxTQUFTLENBQUNFLEdBQUcsQ0FBQyxZQUFZLENBQUM7SUFDckMsQ0FBQyxNQUFNO01BQ0hrRixTQUFTLENBQUMvRSxPQUFPLENBQUMsVUFBQWlGLENBQUM7UUFBQSxPQUFJQSxDQUFDLENBQUN0RixTQUFTLENBQUNFLEdBQUcsQ0FBQyxZQUFZLENBQUM7TUFBQSxFQUFDO01BQ3JEcEIsT0FBTyxDQUFDa0IsU0FBUyxDQUFDQyxNQUFNLENBQUMsU0FBUyxDQUFDO01BQ25DZ0QsS0FBSyxDQUFDakQsU0FBUyxDQUFDQyxNQUFNLENBQUMsWUFBWSxDQUFDO0lBQ3hDO0VBQ0osQ0FBQyxDQUFDO0FBQ04sQ0FBQyxDQUFDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XG5jb25zdCBzdGF0dXNUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXR1cycpO1xuY29uc3Qgc3RhdHVzVGV4dEluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdHVzLXRleHQnKTtcbmNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGFuZF9fbGVmdFwiKTtcbmNvbnN0IHN0YXR1c0JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGFuZF9fc3RhdHVzXCIpO1xuY29uc3QgcmVzdGFydEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmVzdGFydC1nYW1lJyk7XG5jb25zdCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5XCIpO1xuY29uc3Qgc2lkZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1idG4nKTtcbmNvbnN0IHN0YXJ0R2FtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdGFydC1nYW1lJyk7XG5jb25zdCBnYW1lQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWUnKTtcbmNvbnN0IGxhbmRXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxhbmQnKTtcbmNvbnN0IHN0YXR1c0ljb25YID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtcGxheWVyPVwiWFwiXScpO1xuY29uc3Qgc3RhdHVzSWNvbk8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wbGF5ZXI9XCJPXCJdJyk7XG5jb25zdCBnYW1lR3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYW1lLWdyaWQnKTtcbmNvbnN0IHBlcnNMZWZ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWUtcGVycy5fbGVmdCcpO1xuY29uc3QgcGVyc1JpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWUtcGVycy5fcmlnaHQnKTtcbmNvbnN0IGdhbWVPdmVyVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYW1lLW92ZXInKTtcblxubGV0IGJvYXJkID0gWycnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddO1xubGV0IGlzQ29tcHV0ZXJYID0gdHJ1ZTtcbmxldCBjdXJyZW50UGxheWVyLCBjb21wdXRlclBsYXllcjtcblxuZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG5cbmlmIChpc0NvbXB1dGVyWCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNpZGU9XCJYXCJdJykuY2xhc3NMaXN0LnJlbW92ZSgnX2FjdGl2ZScpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNpZGU9XCIwXCJdJykuY2xhc3NMaXN0LmFkZCgnX2FjdGl2ZScpO1xufSBlbHNlIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zaWRlPVwiMFwiXScpLmNsYXNzTGlzdC5yZW1vdmUoJ19hY3RpdmUnKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zaWRlPVwiWFwiXScpLmNsYXNzTGlzdC5hZGQoJ19hY3RpdmUnKTtcbn1cblxuY29uc3Qgd2lubmluZ0NvbWJvcyA9IFtcbiAgICBbMCwgMSwgMl0sXG4gICAgWzMsIDQsIDVdLFxuICAgIFs2LCA3LCA4XSxcbiAgICBbMCwgMywgNl0sXG4gICAgWzEsIDQsIDddLFxuICAgIFsyLCA1LCA4XSxcbiAgICBbMCwgNCwgOF0sXG4gICAgWzIsIDQsIDZdLFxuXTtcblxuZnVuY3Rpb24gaW5pdGlhbGl6ZUdhbWUoKSB7XG4gICAgY3VycmVudFBsYXllciA9IGlzQ29tcHV0ZXJYID8gJ9CT0YDQsNCy0LXRhtGMIDAyJyA6ICfQk9GA0LDQstC10YbRjCAwMSc7XG4gICAgY29tcHV0ZXJQbGF5ZXIgPSBpc0NvbXB1dGVyWCA/ICfQk9GA0LDQstC10YbRjCAwMScgOiAn0JPRgNCw0LLQtdGG0YwgMDInO1xuICAgIGJvYXJkID0gWycnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddO1xuICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiB7XG4gICAgICAgIGNlbGwudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCd0YWtlbicsICdYLXBsYXllcicsICdPLXBsYXllcicpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgbGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53aW4tbGluZScpO1xuICAgIGlmIChsaW5lKSB7XG4gICAgICAgIGxpbmUuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlWCgwKSc7XG4gICAgfVxuXG4gICAgY2hlY2tTdGF0dXNJY29uKGN1cnJlbnRQbGF5ZXIpO1xuICAgIGNoZWNrU3RhdHVzQ29udGFpbmVyKGN1cnJlbnRQbGF5ZXIpO1xuXG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGAke2N1cnJlbnRQbGF5ZXJ9YDtcbiAgICBzdGF0dXNUZXh0SW5mby50ZXh0Q29udGVudCA9IGDQotCS0IbQmV/QpdCG0JRgO1xuICAgIGlmIChjdXJyZW50UGxheWVyID09PSBjb21wdXRlclBsYXllcikge1xuICAgICAgICBzZXRUaW1lb3V0KGJlc3RNb3ZlLCA1MDApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hlY2tTdGF0dXNJY29uKHBsYXllcikge1xuICAgIGlmIChwbGF5ZXIgPT09ICfQk9GA0LDQstC10YbRjCAwMScpIHtcbiAgICAgICAgc3RhdHVzSWNvblguY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIik7XG4gICAgICAgIHN0YXR1c0ljb25PLmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpO1xuICAgIH1cbiAgICBpZiAocGxheWVyID09PSAn0JPRgNCw0LLQtdGG0YwgMDInKSB7XG4gICAgICAgIHN0YXR1c0ljb25PLmNsYXNzTGlzdC5hZGQoXCJfYWN0aXZlXCIpO1xuICAgICAgICBzdGF0dXNJY29uWC5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrU3RhdHVzQ29udGFpbmVyKHBsYXllcikge1xuICAgIGlmIChwbGF5ZXIgPT09ICfQk9GA0LDQstC10YbRjCAwMScpIHtcbiAgICAgICAgc3RhdHVzQm94LmNsYXNzTGlzdC5hZGQoXCJYLXBsYXllclwiKTtcbiAgICAgICAgc3RhdHVzQm94LmNsYXNzTGlzdC5yZW1vdmUoXCJPLXBsYXllclwiKTtcbiAgICB9XG4gICAgaWYgKHBsYXllciA9PT0gJ9CT0YDQsNCy0LXRhtGMIDAyJykge1xuICAgICAgICBzdGF0dXNCb3guY2xhc3NMaXN0LmFkZChcIk8tcGxheWVyXCIpO1xuICAgICAgICBzdGF0dXNCb3guY2xhc3NMaXN0LnJlbW92ZShcIlgtcGxheWVyXCIpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hlY2tXaW5uZXIocGxheWVyKSB7XG4gICAgZm9yIChjb25zdCBjb21ibyBvZiB3aW5uaW5nQ29tYm9zKSB7XG4gICAgICAgIGlmIChjb21iby5ldmVyeShpbmRleCA9PiBib2FyZFtpbmRleF0gPT09IHBsYXllcikpIHtcbiAgICAgICAgICAgIHJldHVybiBjb21ibztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNEcmF3KCkge1xuICAgIHJldHVybiBib2FyZC5ldmVyeShjZWxsID0+IGNlbGwgIT09ICcnKTtcbn1cblxuZnVuY3Rpb24gYmVzdE1vdmUoKSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGxldCBiZXN0U2NvcmUgPSAtSW5maW5pdHk7XG4gICAgICAgIGxldCBtb3ZlO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9IGNvbXB1dGVyUGxheWVyO1xuICAgICAgICAgICAgICAgIGxldCBzY29yZSA9IG1pbmltYXgoYm9hcmQsIDAsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9ICcnO1xuICAgICAgICAgICAgICAgIGlmIChzY29yZSA+IGJlc3RTY29yZSkge1xuICAgICAgICAgICAgICAgICAgICBiZXN0U2NvcmUgPSBzY29yZTtcbiAgICAgICAgICAgICAgICAgICAgbW92ZSA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYm9hcmRbbW92ZV0gPSBjb21wdXRlclBsYXllcjtcblxuICAgICAgICBpZiAoY29tcHV0ZXJQbGF5ZXIgPT09IFwi0JPRgNCw0LLQtdGG0YwgMDJcIikge1xuICAgICAgICAgICAgY2VsbHNbbW92ZV0uY2xhc3NMaXN0LmFkZCgnTy1wbGF5ZXInKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29tcHV0ZXJQbGF5ZXIgPT09IFwi0JPRgNCw0LLQtdGG0YwgMDFcIikge1xuICAgICAgICAgICAgY2VsbHNbbW92ZV0uY2xhc3NMaXN0LmFkZCgnWC1wbGF5ZXInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNoZWNrU3RhdHVzSWNvbihjb21wdXRlclBsYXllcik7XG4gICAgICAgIGNoZWNrU3RhdHVzQ29udGFpbmVyKGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICBzdGF0dXNUZXh0SW5mby50ZXh0Q29udGVudCA9IGDQp9CV0JrQkNCZYDtcblxuICAgICAgICBjZWxsc1ttb3ZlXS5jbGFzc0xpc3QuYWRkKCd0YWtlbicpO1xuXG4gICAgICAgIGNvbnN0IHdpbm5pbmdDb21ibyA9IGNoZWNrV2lubmVyKGNvbXB1dGVyUGxheWVyKTtcbiAgICAgICAgaWYgKHdpbm5pbmdDb21ibykge1xuICAgICAgICAgICAgc2hvd1dpbkxpbmUod2lubmluZ0NvbWJvKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT57XG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGAke2NvbXB1dGVyUGxheWVyfWA7XG4gICAgICAgICAgICAgICAgaGlkZUFmdGVyR2FtZShcImxvc2VcIilcbiAgICAgICAgICAgICAgICBlbmRHYW1lKCk7XG4gICAgICAgICAgICB9LCAxMDAwKVxuICAgICAgICB9IGVsc2UgaWYgKGlzRHJhdygpKSB7XG4gICAgICAgICAgICBoaWRlQWZ0ZXJHYW1lKFwiZHJhd1wiKVxuICAgICAgICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IFwi0J3RltGH0LjRjyFcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRQbGF5ZXIgPSBjdXJyZW50UGxheWVyID09PSAn0JPRgNCw0LLQtdGG0YwgMDEnID8gJ9CT0YDQsNCy0LXRhtGMIDAyJyA6ICfQk9GA0LDQstC10YbRjCAwMSc7XG4gICAgICAgICAgICAgICAgY2hlY2tTdGF0dXNJY29uKGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICAgICAgICAgIGNoZWNrU3RhdHVzQ29udGFpbmVyKGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICAgICAgICAgIHN0YXR1c1RleHRJbmZvLnRleHRDb250ZW50ID0gYNCi0JLQhtCZX9Cl0IbQlGA7XG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGAke2N1cnJlbnRQbGF5ZXJ9YDtcbiAgICAgICAgICAgIH0sIDE1MDApO1xuICAgICAgICB9XG4gICAgfSwgMTAwMCk7XG59XG5cbmZ1bmN0aW9uIG1pbmltYXgoYm9hcmQsIGRlcHRoLCBpc01heGltaXppbmcpIHtcbiAgICBpZiAoY2hlY2tXaW5uZXIoY29tcHV0ZXJQbGF5ZXIpKSByZXR1cm4gMTAgLSBkZXB0aDtcbiAgICBpZiAoY2hlY2tXaW5uZXIoY3VycmVudFBsYXllcikpIHJldHVybiBkZXB0aCAtIDEwO1xuICAgIGlmIChpc0RyYXcoKSkgcmV0dXJuIDA7XG5cbiAgICBpZiAoaXNNYXhpbWl6aW5nKSB7XG4gICAgICAgIGxldCBiZXN0U2NvcmUgPSAtSW5maW5pdHk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9IGNvbXB1dGVyUGxheWVyO1xuICAgICAgICAgICAgICAgIGxldCBzY29yZSA9IG1pbmltYXgoYm9hcmQsIGRlcHRoICsgMSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGJvYXJkW2ldID0gJyc7XG4gICAgICAgICAgICAgICAgYmVzdFNjb3JlID0gTWF0aC5tYXgoc2NvcmUsIGJlc3RTY29yZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJlc3RTY29yZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgYmVzdFNjb3JlID0gSW5maW5pdHk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9IGN1cnJlbnRQbGF5ZXI7XG4gICAgICAgICAgICAgICAgbGV0IHNjb3JlID0gbWluaW1heChib2FyZCwgZGVwdGggKyAxLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9ICcnO1xuICAgICAgICAgICAgICAgIGJlc3RTY29yZSA9IE1hdGgubWluKHNjb3JlLCBiZXN0U2NvcmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiZXN0U2NvcmU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVDZWxsQ2xpY2soZSkge1xuICAgIGNvbnN0IGNlbGwgPSBlLnRhcmdldDtcbiAgICBjb25zdCBpbmRleCA9IGNlbGwuZGF0YXNldC5pbmRleDtcblxuICAgIGlmIChib2FyZFtpbmRleF0gPT09ICcnICYmIGN1cnJlbnRQbGF5ZXIgIT09IGNvbXB1dGVyUGxheWVyKSB7XG4gICAgICAgIGJvYXJkW2luZGV4XSA9IGN1cnJlbnRQbGF5ZXI7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT09IFwi0JPRgNCw0LLQtdGG0YwgMDJcIikge1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdPLXBsYXllcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50UGxheWVyID09PSBcItCT0YDQsNCy0LXRhtGMIDAxXCIpIHtcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnWC1wbGF5ZXInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgndGFrZW4nKTtcblxuICAgICAgICBjb25zdCB3aW5uaW5nQ29tYm8gPSBjaGVja1dpbm5lcihjdXJyZW50UGxheWVyKTtcbiAgICAgICAgaWYgKHdpbm5pbmdDb21ibykge1xuICAgICAgICAgICAgc2hvd1dpbkxpbmUod2lubmluZ0NvbWJvKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgJHtjdXJyZW50UGxheWVyfWA7XG4gICAgICAgICAgICAgICAgaGlkZUFmdGVyR2FtZShcIndpblwiKVxuICAgICAgICAgICAgICAgIGVuZEdhbWUoKTtcbiAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRHJhdygpKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBoaWRlQWZ0ZXJHYW1lKFwiZHJhd1wiKVxuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBcItCd0ZbRh9C40Y8hXCI7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnRQbGF5ZXIgPSBjb21wdXRlclBsYXllcjtcbiAgICAgICAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgJHtjb21wdXRlclBsYXllcn1gO1xuICAgICAgICAgICAgc2V0VGltZW91dChiZXN0TW92ZSwgNTAwKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gaGlkZUFmdGVyR2FtZSh3aW5uZXIpe1xuICAgIGdhbWVDb250YWluZXIuc3R5bGUub3BhY2l0eSA9IFwiMFwiO1xuICAgIGdhbWVHcmlkLnN0eWxlLm9wYWNpdHkgPSBcIjBcIjtcbiAgICBzdGF0dXNCb3guY2xhc3NMaXN0LnJlbW92ZShcIk8tcGxheWVyXCIsIFwiWC1wbGF5ZXJcIik7XG4gICAgcGVyc0xlZnQuc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGVYKDIyMCUpXCI7XG4gICAgcGVyc1JpZ2h0LnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlWCgtMjIwJSkgc2NhbGUoLTEsIDEpXCI7XG5cblxuXG4gICAgaWYod2lubmVyID09PSBcImxvc2VcIil7XG4gICAgICAgIGdhbWVPdmVyVGV4dC50ZXh0Q29udGVudCA9IFwi0L3QtSDQv9C+0YnQsNGB0YLQuNC70L4hXCJcbiAgICB9XG4gICAgaWYod2lubmVyID09PSBcIndpblwiKXtcbiAgICAgICAgZ2FtZU92ZXJUZXh0LnRleHRDb250ZW50ID0gXCLRgtC4INC/0LXRgNC10LzRltCzIVwiXG4gICAgfVxuICAgIGlmKHdpbm5lciA9PT0gXCJkcmF3XCIpe1xuICAgICAgICBnYW1lT3ZlclRleHQudGV4dENvbnRlbnQgPSBcItGC0Lgg0LHRg9CyINC90LAg0YDRltCy0L3RliFcIlxuICAgIH1cblxuICAgIHNldFRpbWVvdXQoKCkgPT57XG4gICAgICAgIGdhbWVPdmVyVGV4dC5jbGFzc0xpc3QucmVtb3ZlKFwib3BhY2l0eVwiKVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+e1xuICAgICAgICAgICAgaWYod2lubmVyID09PSBcImRyYXdcIil7XG4gICAgICAgICAgICAgICAgc2hvd1BvcHVwKFwiLl9kcmF3XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYod2lubmVyID09PSBcIndpblwiKXtcbiAgICAgICAgICAgICAgICBzaG93UG9wdXAoXCIuX3dpblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHdpbm5lciA9PT0gXCJsb3NlXCIpe1xuICAgICAgICAgICAgICAgIHNob3dQb3B1cChcIi5fbG9zZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgNTAwKVxuXG4gICAgfSwgMTAwMClcblxufVxuXG5mdW5jdGlvbiBlbmRHYW1lKCkge1xuICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiBjZWxsLmNsYXNzTGlzdC5hZGQoJ3Rha2VuJykpO1xufVxuXG5yZXN0YXJ0QnRucy5mb3JFYWNoKGJ0biA9PntcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBpc0NvbXB1dGVyWCA9ICFpc0NvbXB1dGVyWDtcbiAgICAgICAgICAgIGluaXRpYWxpemVHYW1lKCk7XG4gICAgICAgICAgICBnYW1lT3ZlclRleHQudGV4dENvbnRlbnQgPSBgYDtcbiAgICAgICAgICAgIGdhbWVHcmlkLnN0eWxlLm9wYWNpdHkgPSBcIjFcIjtcbiAgICAgICAgICAgIGdhbWVDb250YWluZXIuc3R5bGUub3BhY2l0eSA9IFwiMVwiO1xuICAgICAgICAgICAgcGVyc0xlZnQuc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGVYKDAlKVwiO1xuICAgICAgICAgICAgcGVyc1JpZ2h0LnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlWCgwJSkgc2NhbGUoLTEsIDEpXCI7XG4gICAgICAgICAgICBzaWRlQnRucy5mb3JFYWNoKGJ0biA9PiB7XG4gICAgICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpXG4gICAgICAgICAgICAgICAgc3RhcnRHYW1lLmNsYXNzTGlzdC5hZGQoXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlzQ29tcHV0ZXJYKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRHYW1lLmNsYXNzTGlzdC5yZW1vdmUoXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2lkZSA9IGJ0bi5kYXRhc2V0LnNpZGU7XG4gICAgICAgICAgICAgICAgICAgIGlzQ29tcHV0ZXJYID0gc2lkZSAhPT0gJ1gnO1xuICAgICAgICAgICAgICAgICAgICBzaWRlQnRucy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdfYWN0aXZlJykpO1xuICAgICAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgnX2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImF1dG9cIjtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIikuZm9yRWFjaChwb3B1cCA9PiB7XG4gICAgICAgICAgICAgICAgaWYocG9wdXAuY2xhc3NMaXN0LmNvbnRhaW5zKCdfc3RhcnQnKSl7XG4gICAgICAgICAgICAgICAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUtcG9wdXAnKTtcbiAgICAgICAgICAgICAgICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgICAgICAgICAgICAgICAgICBwb3B1cC5zdHlsZS5vcGFjaXR5ID0gXCIxXCI7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ2hpZGUtcG9wdXAnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbn0pXG5cbmNlbGxzLmZvckVhY2goY2VsbCA9PiBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ2VsbENsaWNrKSk7XG5cbnNpZGVCdG5zLmZvckVhY2goYnRuID0+IHtcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNpZGUgPSBidG4uZGF0YXNldC5zaWRlO1xuICAgICAgICBpc0NvbXB1dGVyWCA9IHNpZGUgIT09ICdYJztcbiAgICAgICAgc2lkZUJ0bnMuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnX2FjdGl2ZScpKTtcbiAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoJ19hY3RpdmUnKTtcbiAgICB9KTtcbn0pO1xuXG5zdGFydEdhbWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpZGUtc2VsZWN0aW9uJykuc3R5bGUub3BhY2l0eSA9ICcwJztcbiAgICBnYW1lQ29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSAnMSc7XG4gICAgbGFuZFdyYXBwZXIuY2xhc3NMaXN0LmFkZChcIl9kZWNvclwiKTtcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJhdXRvXCI7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGVuYWJsZU1vdXNlU2NhbGUoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlY29yJykpO1xuICAgIH0sIDI1MDApO1xuICAgIGluaXRpYWxpemVHYW1lKCk7XG4gICAgaGlkZVBvcHVwKFwiI3NpZGUtc2VsZWN0aW9uXCIpO1xufSk7XG5cbmZ1bmN0aW9uIHNob3dQb3B1cChwb3B1cCkge1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHBvcHVwID0gb3ZlcmxheS5xdWVyeVNlbGVjdG9yKHBvcHVwKTtcbiAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwib3BhY2l0eVwiKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT57XG4gICAgICAgICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZS1wb3B1cFwiKTtcbiAgICAgICAgfSwgNTAwKVxuICAgIH0sIDIwMDApXG5cbn1cblxuZnVuY3Rpb24gaGlkZVBvcHVwKHBvcHVwKSB7XG4gICAgcG9wdXAgPSBvdmVybGF5LnF1ZXJ5U2VsZWN0b3IocG9wdXApO1xuICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZChcIm9wYWNpdHlcIik7XG4gICAgcG9wdXAuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG59XG5cbmZ1bmN0aW9uIGVuYWJsZU1vdXNlU2NhbGUoZWxlbWVudCkge1xuICAgIGNvbnN0IG1pblNjYWxlID0gMTtcbiAgICBjb25zdCBtYXhTY2FsZSA9IDEuMDU7XG4gICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwLjFzIGVhc2UnO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpID0+IHtcbiAgICAgICAgY29uc3QgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnN0IHggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7XG4gICAgICAgIGNvbnN0IHkgPSBlLmNsaWVudFkgLSByZWN0LnRvcDtcbiAgICAgICAgY29uc3QgY2VudGVyWCA9IHJlY3Qud2lkdGggLyAyO1xuICAgICAgICBjb25zdCBjZW50ZXJZID0gcmVjdC5oZWlnaHQgLyAyO1xuICAgICAgICBjb25zdCBkaXN0YW5jZSA9IE1hdGguaHlwb3QoeCAtIGNlbnRlclgsIHkgLSBjZW50ZXJZKTtcbiAgICAgICAgY29uc3QgbWF4RGlzdGFuY2UgPSBNYXRoLmh5cG90KGNlbnRlclgsIGNlbnRlclkpO1xuICAgICAgICBjb25zdCBzY2FsZSA9IG1pblNjYWxlICsgKDEgLSBkaXN0YW5jZSAvIG1heERpc3RhbmNlKSAqIChtYXhTY2FsZSAtIG1pblNjYWxlKTtcbiAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHtNYXRoLm1pbihtYXhTY2FsZSwgTWF0aC5tYXgobWluU2NhbGUsIHNjYWxlKSl9KWA7XG4gICAgfSk7XG5cbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG4gICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7bWluU2NhbGV9KWA7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHNob3dXaW5MaW5lKGNvbWJvKSB7XG4gICAgY29uc3QgbGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53aW4tbGluZScpO1xuICAgIGxpbmUuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlWCgwKSc7XG4gICAgLy8gbGluZS5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAvLyBsaW5lLnN0eWxlLmhlaWdodCA9ICc0NHB4JztcbiAgICAvLyBsaW5lLnN0eWxlLmJhY2tncm91bmQgPSAnIzAwZjBmZic7XG5cbiAgICBjb25zdCBwb3NpdGlvbnMgPSB7XG4gICAgICAgICcwLDEsMic6IHsgdG9wOiAnMjYlJywgbGVmdDogJzUwJScsIHJvdGF0ZTogJzBkZWcnLCB3aWR0aDogJzgwJScgfSxcbiAgICAgICAgJzMsNCw1JzogeyB0b3A6ICc1MCUnLCBsZWZ0OiAnNTAlJywgcm90YXRlOiAnMGRlZycsIHdpZHRoOiAnODAlJyB9LFxuICAgICAgICAnNiw3LDgnOiB7IHRvcDogJzc4LjMzJScsIGxlZnQ6ICc1MCUnLCByb3RhdGU6ICcwZGVnJywgd2lkdGg6ICc4MCUnIH0sXG4gICAgICAgICcwLDMsNic6IHsgdG9wOiAnNTAlJywgbGVmdDogJzI0LjUlJywgcm90YXRlOiAnOTBkZWcnLCB3aWR0aDogJzgwJSd9LFxuICAgICAgICAnMSw0LDcnOiB7IHRvcDogJzUwJScsIGxlZnQ6ICc1MCUnLCByb3RhdGU6ICc5MGRlZycsIHdpZHRoOiAnODAlJyB9LFxuICAgICAgICAnMiw1LDgnOiB7IHRvcDogJzUwJScsIGxlZnQ6ICc3Ni41JScsIHJvdGF0ZTogJzkwZGVnJywgd2lkdGg6ICc4MCUnIH0sXG4gICAgICAgICcwLDQsOCc6IHsgdG9wOiAnNTAlJywgbGVmdDogJzUwJScsIHJvdGF0ZTogJzQ1ZGVnJywgd2lkdGg6ICcxMDAlJyB9LFxuICAgICAgICAnMiw0LDYnOiB7IHRvcDogJzUwJScsIGxlZnQ6ICc1MCUnLCByb3RhdGU6ICctNDVkZWcnLCB3aWR0aDogJzEwMCUnIH0sXG4gICAgfTtcblxuICAgIGNvbnN0IGtleSA9IGNvbWJvLnNvcnQoKGEsIGIpID0+IGEgLSBiKS5qb2luKCcsJyk7XG5cbiAgICBjb25zb2xlLmxvZyhrZXkpO1xuXG4gICAgY29uc3QgcG9zID0gcG9zaXRpb25zW2tleV07XG5cbiAgICBjb25zb2xlLmxvZyhwb3Mud2lkdGgpO1xuXG4gICAgbGV0IHdpZHRoID0gcG9zLndpZHRoO1xuXG4gICAgaWYgKHBvcykge1xuICAgICAgICBsaW5lLnN0eWxlLnRvcCA9IHBvcy50b3A7XG4gICAgICAgIGxpbmUuc3R5bGUubGVmdCA9IHBvcy5sZWZ0O1xuICAgICAgICBsaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgcm90YXRlKCR7cG9zLnJvdGF0ZX0pIHNjYWxlWCgxKWA7XG4gICAgICAgIGxpbmUuc3R5bGUud2lkdGggPSBgJHtwb3Mud2lkdGh9YDtcbiAgICAgICAgbGluZS5zdHlsZS5vcGFjaXR5ID0gYDFgO1xuICAgIH1cbn1cblxuLy8gdGVzdFxuY29uc3QgdGVzdFBvcHVwQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50ZXN0LXBvcHVwJyk7XG50ZXN0UG9wdXBCdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBvcHVwQ2xhc3MgPSBidXR0b24uZGF0YXNldC5wb3B1cDtcbiAgICAgICAgY29uc3QgcG9wdXAgPSBvdmVybGF5LnF1ZXJ5U2VsZWN0b3IocG9wdXBDbGFzcyk7XG4gICAgICAgIGNvbnN0IGFsbFBvcHVwcyA9IG92ZXJsYXkucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwJyk7XG4gICAgICAgIGNvbnN0IGlzQWxyZWFkeU9wZW4gPSAhcG9wdXAuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRlLXBvcHVwJyk7XG5cbiAgICAgICAgaWYgKGlzQWxyZWFkeU9wZW4pIHtcbiAgICAgICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnb3BhY2l0eScpO1xuICAgICAgICAgICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnaGlkZS1wb3B1cCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWxsUG9wdXBzLmZvckVhY2gocCA9PiBwLmNsYXNzTGlzdC5hZGQoJ2hpZGUtcG9wdXAnKSk7XG4gICAgICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ29wYWNpdHknKTtcbiAgICAgICAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUtcG9wdXAnKTtcbiAgICAgICAgfVxuICAgIH0pO1xufSk7XG4iXX0=
