"use strict";

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }
function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }
function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }
var cells = document.querySelectorAll('.cell');
var statusText = document.getElementById('status');
var statusTextInfo = document.getElementById('status-text');
var statusContainer = document.querySelector(".land__left");
var statusBox = document.querySelector(".land__status");
var restartBtn = document.getElementById('restart');
var overlay = document.querySelector(".overlay");
var sideBtns = document.querySelectorAll('.side-btn');
var startGame = document.querySelector('.start-game');
var gameContainer = document.getElementById('game');
var landWrapper = document.querySelector('.land');
var statusIconX = document.querySelector('[data-player="X"]');
var statusIconO = document.querySelector('[data-player="O"]');
var board = ['', '', '', '', '', '', '', '', ''];
var isComputerX = true; // Чередує роль комп'ютера між X та O
var currentPlayer, computerPlayer;
if (isComputerX) {
  document.querySelector('[data-side="X"]').classList.remove('_active');
  document.querySelector('[data-side="0"]').classList.add('_active');
} else {
  document.querySelector('[data-side="0"]').classList.remove('_active');
  document.querySelector('[data-side="X"]').classList.add('_active');
}
var winningCombos = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
function initializeGame() {
  currentPlayer = isComputerX ? 'Гравець 02' : 'Гравець 01';
  computerPlayer = isComputerX ? 'Гравець 01' : 'Гравець 02';
  board = ['', '', '', '', '', '', '', '', ''];
  cells.forEach(function (cell) {
    cell.textContent = '';
    cell.classList.remove('taken');
  });
  checkStatusIcon(currentPlayer);
  checkStatusContainer(currentPlayer);
  statusText.textContent = "".concat(currentPlayer);
  statusTextInfo.textContent = "\u0422\u0412\u0406\u0419_\u0425\u0406\u0414";
  if (currentPlayer === computerPlayer) {
    setTimeout(bestMove, 500);
  }
}
function checkStatusIcon(player) {
  console.log(player);
  if (player === 'Гравець 01') {
    statusIconX.classList.add("_active");
    statusIconO.classList.remove("_active");
  }
  if (player === 'Гравець 02') {
    statusIconO.classList.add("_active");
    statusIconX.classList.remove("_active");
  }
}
function checkStatusContainer(player) {
  console.log(player);
  if (player === 'Гравець 01') {
    statusBox.classList.add("X-player");
    statusBox.classList.remove("O-player");
  }
  if (player === 'Гравець 02') {
    statusBox.classList.add("O-player");
    statusBox.classList.remove("X-player");
  }
}
function checkWinner(player) {
  var _iterator = _createForOfIteratorHelper(winningCombos),
    _step;
  try {
    for (_iterator.s(); !(_step = _iterator.n()).done;) {
      var combo = _step.value;
      if (combo.every(function (index) {
        return board[index] === player;
      })) {
        return combo;
      }
    }
  } catch (err) {
    _iterator.e(err);
  } finally {
    _iterator.f();
  }
  return null;
}

// function checkWinner(player) {
//     return winningCombos.some(combo =>
//         combo.every(index => board[index] === player)
//     );
// }

function isDraw() {
  return board.every(function (cell) {
    return cell !== '';
  });
}
function bestMove() {
  setTimeout(function () {
    var bestScore = -Infinity;
    var move;
    for (var i = 0; i < board.length; i++) {
      if (board[i] === '') {
        board[i] = computerPlayer;
        var score = minimax(board, 0, false);
        board[i] = '';
        if (score > bestScore) {
          bestScore = score;
          move = i;
        }
      }
    }
    board[move] = computerPlayer;

    // cells[move].classList.add('taken');

    if (computerPlayer === "Гравець 02") {
      cells[move].classList.add('O-player');
    }
    if (computerPlayer === "Гравець 01") {
      cells[move].classList.add('X-player');
    }
    checkStatusIcon(computerPlayer);
    checkStatusContainer(currentPlayer);
    statusTextInfo.textContent = "\u0427\u0415\u041A\u0410\u0419";

    // cells[move].textContent = computerPlayer;
    cells[move].classList.add('taken');
    if (checkWinner(computerPlayer)) {
      statusText.textContent = "".concat(computerPlayer);
      showPopup("._lose");
      endGame();
    } else if (isDraw()) {
      showPopup("._draw");
      statusText.textContent = "Нічия!";
    } else {
      setTimeout(function () {
        currentPlayer = currentPlayer === 'Гравець 01' ? 'Гравець 02' : 'Гравець 01';
        checkStatusIcon(currentPlayer);
        checkStatusContainer(currentPlayer);
        statusTextInfo.textContent = "\u0422\u0412\u0406\u0419_\u0425\u0406\u0414";
        statusText.textContent = "".concat(currentPlayer);
      }, 1500);
    }
  }, 1000);
}
function minimax(board, depth, isMaximizing) {
  if (checkWinner(computerPlayer)) return 10 - depth; // Комп'ютер виграв
  if (checkWinner(currentPlayer)) return depth - 10; // Гравець виграв
  if (isDraw()) return 0; // Нічия

  if (isMaximizing) {
    var bestScore = -Infinity;
    for (var i = 0; i < board.length; i++) {
      if (board[i] === '') {
        board[i] = computerPlayer;
        var score = minimax(board, depth + 1, false);
        board[i] = '';
        bestScore = Math.max(score, bestScore);
      }
    }
    return bestScore;
  } else {
    var _bestScore = Infinity;
    for (var _i = 0; _i < board.length; _i++) {
      if (board[_i] === '') {
        board[_i] = currentPlayer;
        var _score = minimax(board, depth + 1, true);
        board[_i] = '';
        _bestScore = Math.min(_score, _bestScore);
      }
    }
    return _bestScore;
  }
}
function handleCellClick(e) {
  var cell = e.target;
  var index = cell.dataset.index;
  if (board[index] === '' && currentPlayer !== computerPlayer) {
    board[index] = currentPlayer;
    console.log(currentPlayer);
    if (currentPlayer === "Гравець 02") {
      cell.classList.add('O-player');
    }
    if (currentPlayer === "Гравець 01") {
      cell.classList.add('X-player');
    }

    // cell.textContent = currentPlayer;
    cell.classList.add('taken');
    if (checkWinner(currentPlayer)) {
      setTimeout(function () {
        statusText.textContent = "".concat(currentPlayer);
        showPopup("._win");
        endGame();
      }, 2000);
    } else if (isDraw()) {
      setTimeout(function () {
        showPopup("._draw");
        statusText.textContent = "Нічия!";
      }, 2000);
    } else {
      currentPlayer = computerPlayer;
      statusText.textContent = "".concat(computerPlayer);
      setTimeout(bestMove, 500);
    }
  }
}
function endGame() {
  cells.forEach(function (cell) {
    return cell.classList.add('taken');
  });
}
restartBtn.addEventListener('click', function () {
  isComputerX = !isComputerX; // Чередуємо ролі
  initializeGame();
});
cells.forEach(function (cell) {
  return cell.addEventListener('click', handleCellClick);
});
sideBtns.forEach(function (btn) {
  btn.addEventListener('click', function () {
    var side = btn.dataset.side;
    isComputerX = side !== 'X'; // Якщо гравець X, комп'ютер буде O
    sideBtns.forEach(function (item) {
      return item.classList.remove('_active');
    });
    btn.classList.add('_active');
  });
});
startGame.addEventListener('click', function () {
  document.getElementById('side-selection').style.opacity = '0';
  gameContainer.style.opacity = '1';
  restartBtn.style.display = '';
  landWrapper.classList.add("_decor");
  setTimeout(function () {
    enableMouseScale(document.querySelector('.decor'));
  }, 2500);
  initializeGame();
  hidePopup("#side-selection");
});
function showPopup(popup) {
  console.log(popup);
  popup = overlay.querySelector(popup);
  overlay.classList.remove("opacity");
  popup.classList.remove("hide");
}
function hidePopup(popup) {
  popup = overlay.querySelector(popup);
  overlay.classList.add("opacity");
  popup.classList.add("hide");
}
function enableMouseScale(element) {
  var minScale = 1;
  var maxScale = 1.05;
  element.style.transition = 'transform 0.1s ease';
  document.addEventListener('mousemove', function (e) {
    var rect = element.getBoundingClientRect();
    var x = e.clientX - rect.left;
    var y = e.clientY - rect.top;
    var centerX = rect.width / 2;
    var centerY = rect.height / 2;
    var distance = Math.hypot(x - centerX, y - centerY);
    var maxDistance = Math.hypot(centerX, centerY);
    var scale = minScale + (1 - distance / maxDistance) * (maxScale - minScale);
    element.style.transform = "scale(".concat(Math.min(maxScale, Math.max(minScale, scale)), ")");
  });
  element.addEventListener('mouseleave', function () {
    element.style.transform = "scale(".concat(minScale, ")");
  });
}
function showWinLine(combo) {
  var line = document.querySelector('.win-line');
  line.style.transform = 'scaleX(0)'; // Reset before new line
  line.style.width = '100%';
  line.style.height = '4px';
  line.style.background = '#00f0ff';

  // Клітинки мають індекси від 0 до 8:
  // 0 | 1 | 2
  // 3 | 4 | 5
  // 6 | 7 | 8

  var positions = {
    '0,1,2': {
      top: '16.66%',
      left: '50%',
      rotate: '0deg'
    },
    '3,4,5': {
      top: '50%',
      left: '50%',
      rotate: '0deg'
    },
    '6,7,8': {
      top: '83.33%',
      left: '50%',
      rotate: '0deg'
    },
    '0,3,6': {
      top: '50%',
      left: '16.66%',
      rotate: '90deg'
    },
    '1,4,7': {
      top: '50%',
      left: '50%',
      rotate: '90deg'
    },
    '2,5,8': {
      top: '50%',
      left: '83.33%',
      rotate: '90deg'
    },
    '0,4,8': {
      top: '50%',
      left: '50%',
      rotate: '45deg'
    },
    '2,4,6': {
      top: '50%',
      left: '50%',
      rotate: '-45deg'
    }
  };
  var key = combo.sort(function (a, b) {
    return a - b;
  }).join(',');
  var pos = positions[key];
  if (pos) {
    line.style.top = pos.top;
    line.style.left = pos.left;
    line.style.transform = "translate(-50%, -50%) rotate(".concat(pos.rotate, ") scaleX(1)");
  }
}

// test
var testPopupButtons = document.querySelectorAll('.test-popup');
testPopupButtons.forEach(function (button) {
  button.addEventListener('click', function () {
    var popupClass = button.dataset.popup;
    var popup = overlay.querySelector(popupClass);
    var allPopups = overlay.querySelectorAll('.popup');
    var isAlreadyOpen = !popup.classList.contains('hide');
    if (isAlreadyOpen) {
      overlay.classList.add('opacity');
      popup.classList.add('hide');
    } else {
      allPopups.forEach(function (p) {
        return p.classList.add('hide');
      });
      overlay.classList.remove('opacity');
      popup.classList.remove('hide');
    }
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiY2VsbHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzdGF0dXNUZXh0IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdGF0dXNUZXh0SW5mbyIsInN0YXR1c0NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzdGF0dXNCb3giLCJyZXN0YXJ0QnRuIiwib3ZlcmxheSIsInNpZGVCdG5zIiwic3RhcnRHYW1lIiwiZ2FtZUNvbnRhaW5lciIsImxhbmRXcmFwcGVyIiwic3RhdHVzSWNvblgiLCJzdGF0dXNJY29uTyIsImJvYXJkIiwiaXNDb21wdXRlclgiLCJjdXJyZW50UGxheWVyIiwiY29tcHV0ZXJQbGF5ZXIiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJ3aW5uaW5nQ29tYm9zIiwiaW5pdGlhbGl6ZUdhbWUiLCJmb3JFYWNoIiwiY2VsbCIsInRleHRDb250ZW50IiwiY2hlY2tTdGF0dXNJY29uIiwiY2hlY2tTdGF0dXNDb250YWluZXIiLCJzZXRUaW1lb3V0IiwiYmVzdE1vdmUiLCJwbGF5ZXIiLCJjb25zb2xlIiwibG9nIiwiY2hlY2tXaW5uZXIiLCJjb21ibyIsImV2ZXJ5IiwiaW5kZXgiLCJpc0RyYXciLCJiZXN0U2NvcmUiLCJJbmZpbml0eSIsIm1vdmUiLCJpIiwibGVuZ3RoIiwic2NvcmUiLCJtaW5pbWF4Iiwic2hvd1BvcHVwIiwiZW5kR2FtZSIsImRlcHRoIiwiaXNNYXhpbWl6aW5nIiwiTWF0aCIsIm1heCIsIm1pbiIsImhhbmRsZUNlbGxDbGljayIsImUiLCJ0YXJnZXQiLCJkYXRhc2V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImJ0biIsInNpZGUiLCJpdGVtIiwic3R5bGUiLCJvcGFjaXR5IiwiZGlzcGxheSIsImVuYWJsZU1vdXNlU2NhbGUiLCJoaWRlUG9wdXAiLCJwb3B1cCIsImVsZW1lbnQiLCJtaW5TY2FsZSIsIm1heFNjYWxlIiwidHJhbnNpdGlvbiIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ4IiwiY2xpZW50WCIsImxlZnQiLCJ5IiwiY2xpZW50WSIsInRvcCIsImNlbnRlclgiLCJ3aWR0aCIsImNlbnRlclkiLCJoZWlnaHQiLCJkaXN0YW5jZSIsImh5cG90IiwibWF4RGlzdGFuY2UiLCJzY2FsZSIsInRyYW5zZm9ybSIsInNob3dXaW5MaW5lIiwibGluZSIsImJhY2tncm91bmQiLCJwb3NpdGlvbnMiLCJyb3RhdGUiLCJrZXkiLCJzb3J0IiwiYSIsImIiLCJqb2luIiwicG9zIiwidGVzdFBvcHVwQnV0dG9ucyIsImJ1dHRvbiIsInBvcHVwQ2xhc3MiLCJhbGxQb3B1cHMiLCJpc0FscmVhZHlPcGVuIiwiY29udGFpbnMiLCJwIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLElBQU1BLEtBQUssR0FBR0MsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUM7QUFDaEQsSUFBTUMsVUFBVSxHQUFHRixRQUFRLENBQUNHLGNBQWMsQ0FBQyxRQUFRLENBQUM7QUFDcEQsSUFBTUMsY0FBYyxHQUFHSixRQUFRLENBQUNHLGNBQWMsQ0FBQyxhQUFhLENBQUM7QUFDN0QsSUFBTUUsZUFBZSxHQUFHTCxRQUFRLENBQUNNLGFBQWEsQ0FBQyxhQUFhLENBQUM7QUFDN0QsSUFBTUMsU0FBUyxHQUFHUCxRQUFRLENBQUNNLGFBQWEsQ0FBQyxlQUFlLENBQUM7QUFDekQsSUFBTUUsVUFBVSxHQUFHUixRQUFRLENBQUNHLGNBQWMsQ0FBQyxTQUFTLENBQUM7QUFDckQsSUFBTU0sT0FBTyxHQUFHVCxRQUFRLENBQUNNLGFBQWEsQ0FBQyxVQUFVLENBQUM7QUFDbEQsSUFBTUksUUFBUSxHQUFHVixRQUFRLENBQUNDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQztBQUN2RCxJQUFNVSxTQUFTLEdBQUdYLFFBQVEsQ0FBQ00sYUFBYSxDQUFDLGFBQWEsQ0FBQztBQUN2RCxJQUFNTSxhQUFhLEdBQUdaLFFBQVEsQ0FBQ0csY0FBYyxDQUFDLE1BQU0sQ0FBQztBQUNyRCxJQUFNVSxXQUFXLEdBQUdiLFFB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U0FBUyxDQUFDQyxNQUFNLENBQUMsU0FBUyxDQUFDO01BQ25DOEMsS0FBSyxDQUFDL0MsU0FBUyxDQUFDQyxNQUFNLENBQUMsTUFBTSxDQUFDO0lBQ2xDO0VBQ0osQ0FBQyxDQUFDO0FBQ04sQ0FBQyxDQUFDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XG5jb25zdCBzdGF0dXNUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXR1cycpO1xuY29uc3Qgc3RhdHVzVGV4dEluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdHVzLXRleHQnKTtcbmNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGFuZF9fbGVmdFwiKVxuY29uc3Qgc3RhdHVzQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5sYW5kX19zdGF0dXNcIilcbmNvbnN0IHJlc3RhcnRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGFydCcpO1xuY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKTtcbmNvbnN0IHNpZGVCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtYnRuJyk7XG5jb25zdCBzdGFydEdhbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3RhcnQtZ2FtZScpO1xuY29uc3QgZ2FtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYW1lJyk7XG5jb25zdCBsYW5kV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sYW5kJyk7XG5jb25zdCBzdGF0dXNJY29uWCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXBsYXllcj1cIlhcIl0nKTtcbmNvbnN0IHN0YXR1c0ljb25PID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtcGxheWVyPVwiT1wiXScpO1xuXG5cbmxldCBib2FyZCA9IFsnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnXTtcbmxldCBpc0NvbXB1dGVyWCA9IHRydWU7IC8vINCn0LXRgNC10LTRg9GUINGA0L7Qu9GMINC60L7QvNC/J9GO0YLQtdGA0LAg0LzRltC2IFgg0YLQsCBPXG5sZXQgY3VycmVudFBsYXllciwgY29tcHV0ZXJQbGF5ZXI7XG5cbmlmIChpc0NvbXB1dGVyWCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNpZGU9XCJYXCJdJykuY2xhc3NMaXN0LnJlbW92ZSgnX2FjdGl2ZScpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNpZGU9XCIwXCJdJykuY2xhc3NMaXN0LmFkZCgnX2FjdGl2ZScpO1xufWVsc2V7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtc2lkZT1cIjBcIl0nKS5jbGFzc0xpc3QucmVtb3ZlKCdfYWN0aXZlJyk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtc2lkZT1cIlhcIl0nKS5jbGFzc0xpc3QuYWRkKCdfYWN0aXZlJyk7XG59XG5cbmNvbnN0IHdpbm5pbmdDb21ib3MgPSBbXG4gICAgWzAsIDEsIDJdLFxuICAgIFszLCA0LCA1XSxcbiAgICBbNiwgNywgOF0sXG4gICAgWzAsIDMsIDZdLFxuICAgIFsxLCA0LCA3XSxcbiAgICBbMiwgNSwgOF0sXG4gICAgWzAsIDQsIDhdLFxuICAgIFsyLCA0LCA2XSxcbl07XG5cbmZ1bmN0aW9uIGluaXRpYWxpemVHYW1lKCkge1xuICAgIGN1cnJlbnRQbGF5ZXIgPSBpc0NvbXB1dGVyWCA/ICfQk9GA0LDQstC10YbRjCAwMicgOiAn0JPRgNCw0LLQtdGG0YwgMDEnO1xuICAgIGNvbXB1dGVyUGxheWVyID0gaXNDb21wdXRlclggPyAn0JPRgNCw0LLQtdGG0YwgMDEnIDogJ9CT0YDQsNCy0LXRhtGMIDAyJztcbiAgICBib2FyZCA9IFsnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnXTtcbiAgICBjZWxscy5mb3JFYWNoKGNlbGwgPT4ge1xuICAgICAgICBjZWxsLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgndGFrZW4nKTtcbiAgICB9KTtcblxuICAgIGNoZWNrU3RhdHVzSWNvbihjdXJyZW50UGxheWVyKVxuICAgIGNoZWNrU3RhdHVzQ29udGFpbmVyKGN1cnJlbnRQbGF5ZXIpXG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYCR7Y3VycmVudFBsYXllcn1gO1xuICAgIHN0YXR1c1RleHRJbmZvLnRleHRDb250ZW50ID0gYNCi0JLQhtCZX9Cl0IbQlGA7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT09IGNvbXB1dGVyUGxheWVyKSB7XG4gICAgICAgIHNldFRpbWVvdXQoYmVzdE1vdmUsIDUwMCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjaGVja1N0YXR1c0ljb24ocGxheWVyKSB7XG5cbiAgICBjb25zb2xlLmxvZyhwbGF5ZXIpXG5cbiAgICBpZihwbGF5ZXIgPT09ICfQk9GA0LDQstC10YbRjCAwMScpe1xuICAgICAgICBzdGF0dXNJY29uWC5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgc3RhdHVzSWNvbk8uY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIik7XG4gICAgfVxuICAgIGlmKHBsYXllciA9PT0gJ9CT0YDQsNCy0LXRhtGMIDAyJyl7XG4gICAgICAgIHN0YXR1c0ljb25PLmNsYXNzTGlzdC5hZGQoXCJfYWN0aXZlXCIpO1xuICAgICAgICBzdGF0dXNJY29uWC5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrU3RhdHVzQ29udGFpbmVyKHBsYXllcikge1xuXG4gICAgY29uc29sZS5sb2cocGxheWVyKVxuXG4gICAgaWYocGxheWVyID09PSAn0JPRgNCw0LLQtdGG0YwgMDEnKXtcbiAgICAgICAgc3RhdHVzQm94LmNsYXNzTGlzdC5hZGQoXCJYLXBsYXllclwiKTtcbiAgICAgICAgc3RhdHVzQm94LmNsYXNzTGlzdC5yZW1vdmUoXCJPLXBsYXllclwiKTtcbiAgICB9XG4gICAgaWYocGxheWVyID09PSAn0JPRgNCw0LLQtdGG0YwgMDInKXtcbiAgICAgICAgc3RhdHVzQm94LmNsYXNzTGlzdC5hZGQoXCJPLXBsYXllclwiKTtcbiAgICAgICAgc3RhdHVzQm94LmNsYXNzTGlzdC5yZW1vdmUoXCJYLXBsYXllclwiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrV2lubmVyKHBsYXllcikge1xuICAgIGZvciAoY29uc3QgY29tYm8gb2Ygd2lubmluZ0NvbWJvcykge1xuICAgICAgICBpZiAoY29tYm8uZXZlcnkoaW5kZXggPT4gYm9hcmRbaW5kZXhdID09PSBwbGF5ZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gY29tYm87XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cblxuLy8gZnVuY3Rpb24gY2hlY2tXaW5uZXIocGxheWVyKSB7XG4vLyAgICAgcmV0dXJuIHdpbm5pbmdDb21ib3Muc29tZShjb21ibyA9PlxuLy8gICAgICAgICBjb21iby5ldmVyeShpbmRleCA9PiBib2FyZFtpbmRleF0gPT09IHBsYXllcilcbi8vICAgICApO1xuLy8gfVxuXG5mdW5jdGlvbiBpc0RyYXcoKSB7XG4gICAgcmV0dXJuIGJvYXJkLmV2ZXJ5KGNlbGwgPT4gY2VsbCAhPT0gJycpO1xufVxuXG5mdW5jdGlvbiBiZXN0TW92ZSgpIHtcblxuICAgIHNldFRpbWVvdXQoKCkgPT57XG4gICAgICAgIGxldCBiZXN0U2NvcmUgPSAtSW5maW5pdHk7XG4gICAgICAgIGxldCBtb3ZlO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9IGNvbXB1dGVyUGxheWVyO1xuICAgICAgICAgICAgICAgIGxldCBzY29yZSA9IG1pbmltYXgoYm9hcmQsIDAsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9ICcnO1xuICAgICAgICAgICAgICAgIGlmIChzY29yZSA+IGJlc3RTY29yZSkge1xuICAgICAgICAgICAgICAgICAgICBiZXN0U2NvcmUgPSBzY29yZTtcbiAgICAgICAgICAgICAgICAgICAgbW92ZSA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJvYXJkW21vdmVdID0gY29tcHV0ZXJQbGF5ZXI7XG5cbiAgICAgICAgLy8gY2VsbHNbbW92ZV0uY2xhc3NMaXN0LmFkZCgndGFrZW4nKTtcblxuICAgICAgICBpZihjb21wdXRlclBsYXllciA9PT0gXCLQk9GA0LDQstC10YbRjCAwMlwiKSB7XG4gICAgICAgICAgICBjZWxsc1ttb3ZlXS5jbGFzc0xpc3QuYWRkKCdPLXBsYXllcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmKGNvbXB1dGVyUGxheWVyID09PSBcItCT0YDQsNCy0LXRhtGMIDAxXCIpIHtcbiAgICAgICAgICAgIGNlbGxzW21vdmVdLmNsYXNzTGlzdC5hZGQoJ1gtcGxheWVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2hlY2tTdGF0dXNJY29uKGNvbXB1dGVyUGxheWVyKVxuICAgICAgICBjaGVja1N0YXR1c0NvbnRhaW5lcihjdXJyZW50UGxheWVyKVxuICAgICAgICBzdGF0dXNUZXh0SW5mby50ZXh0Q29udGVudCA9IGDQp9CV0JrQkNCZYDtcblxuICAgICAgICAvLyBjZWxsc1ttb3ZlXS50ZXh0Q29udGVudCA9IGNvbXB1dGVyUGxheWVyO1xuICAgICAgICBjZWxsc1ttb3ZlXS5jbGFzc0xpc3QuYWRkKCd0YWtlbicpO1xuICAgICAgICBpZiAoY2hlY2tXaW5uZXIoY29tcHV0ZXJQbGF5ZXIpKSB7XG4gICAgICAgICAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYCR7Y29tcHV0ZXJQbGF5ZXJ9YDtcbiAgICAgICAgICAgIHNob3dQb3B1cChcIi5fbG9zZVwiKVxuICAgICAgICAgICAgZW5kR2FtZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRHJhdygpKSB7XG4gICAgICAgICAgICBzaG93UG9wdXAoXCIuX2RyYXdcIilcbiAgICAgICAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBcItCd0ZbRh9C40Y8hXCI7XG5cbiAgICAgICAgfSBlbHNlIHtcblxuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+e1xuICAgICAgICAgICAgICAgIGN1cnJlbnRQbGF5ZXIgPSBjdXJyZW50UGxheWVyID09PSAn0JPRgNCw0LLQtdGG0YwgMDEnID8gJ9CT0YDQsNCy0LXRhtGMIDAyJyA6ICfQk9GA0LDQstC10YbRjCAwMSc7XG4gICAgICAgICAgICAgICAgY2hlY2tTdGF0dXNJY29uKGN1cnJlbnRQbGF5ZXIpXG4gICAgICAgICAgICAgICAgY2hlY2tTdGF0dXNDb250YWluZXIoY3VycmVudFBsYXllcilcbiAgICAgICAgICAgICAgICBzdGF0dXNUZXh0SW5mby50ZXh0Q29udGVudCA9IGDQotCS0IbQmV/QpdCG0JRgO1xuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgJHtjdXJyZW50UGxheWVyfWA7XG5cbiAgICAgICAgICAgIH0sIDE1MDApXG4gICAgICAgIH1cbiAgICB9LCAxMDAwKVxuXG5cbn1cblxuZnVuY3Rpb24gbWluaW1heChib2FyZCwgZGVwdGgsIGlzTWF4aW1pemluZykge1xuICAgIGlmIChjaGVja1dpbm5lcihjb21wdXRlclBsYXllcikpIHJldHVybiAxMCAtIGRlcHRoOyAvLyDQmtC+0LzQvyfRjtGC0LXRgCDQstC40LPRgNCw0LJcbiAgICBpZiAoY2hlY2tXaW5uZXIoY3VycmVudFBsYXllcikpIHJldHVybiBkZXB0aCAtIDEwOyAvLyDQk9GA0LDQstC10YbRjCDQstC40LPRgNCw0LJcbiAgICBpZiAoaXNEcmF3KCkpIHJldHVybiAwOyAvLyDQndGW0YfQuNGPXG5cbiAgICBpZiAoaXNNYXhpbWl6aW5nKSB7XG4gICAgICAgIGxldCBiZXN0U2NvcmUgPSAtSW5maW5pdHk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9IGNvbXB1dGVyUGxheWVyO1xuICAgICAgICAgICAgICAgIGxldCBzY29yZSA9IG1pbmltYXgoYm9hcmQsIGRlcHRoICsgMSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGJvYXJkW2ldID0gJyc7XG4gICAgICAgICAgICAgICAgYmVzdFNjb3JlID0gTWF0aC5tYXgoc2NvcmUsIGJlc3RTY29yZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJlc3RTY29yZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgYmVzdFNjb3JlID0gSW5maW5pdHk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9IGN1cnJlbnRQbGF5ZXI7XG4gICAgICAgICAgICAgICAgbGV0IHNjb3JlID0gbWluaW1heChib2FyZCwgZGVwdGggKyAxLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBib2FyZFtpXSA9ICcnO1xuICAgICAgICAgICAgICAgIGJlc3RTY29yZSA9IE1hdGgubWluKHNjb3JlLCBiZXN0U2NvcmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiZXN0U2NvcmU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVDZWxsQ2xpY2soZSkge1xuICAgIGNvbnN0IGNlbGwgPSBlLnRhcmdldDtcbiAgICBjb25zdCBpbmRleCA9IGNlbGwuZGF0YXNldC5pbmRleDtcblxuICAgIGlmIChib2FyZFtpbmRleF0gPT09ICcnICYmIGN1cnJlbnRQbGF5ZXIgIT09IGNvbXB1dGVyUGxheWVyKSB7XG4gICAgICAgIGJvYXJkW2luZGV4XSA9IGN1cnJlbnRQbGF5ZXI7XG5cbiAgICAgICBjb25zb2xlLmxvZyhjdXJyZW50UGxheWVyKTtcblxuICAgICAgIGlmKGN1cnJlbnRQbGF5ZXIgPT09IFwi0JPRgNCw0LLQtdGG0YwgMDJcIikge1xuICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ08tcGxheWVyJyk7XG4gICAgICAgfVxuICAgICAgICBpZihjdXJyZW50UGxheWVyID09PSBcItCT0YDQsNCy0LXRhtGMIDAxXCIpIHtcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnWC1wbGF5ZXInKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gY2VsbC50ZXh0Q29udGVudCA9IGN1cnJlbnRQbGF5ZXI7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgndGFrZW4nKTtcblxuICAgICAgICBpZiAoY2hlY2tXaW5uZXIoY3VycmVudFBsYXllcikpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT57XG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGAke2N1cnJlbnRQbGF5ZXJ9YDtcbiAgICAgICAgICAgICAgICBzaG93UG9wdXAoXCIuX3dpblwiKVxuICAgICAgICAgICAgICAgIGVuZEdhbWUoKTtcbiAgICAgICAgICAgIH0sIDIwMDApXG5cbiAgICAgICAgfSBlbHNlIGlmIChpc0RyYXcoKSkge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PntcbiAgICAgICAgICAgICAgICBzaG93UG9wdXAoXCIuX2RyYXdcIilcbiAgICAgICAgICAgICAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gXCLQndGW0YfQuNGPIVwiO1xuICAgICAgICAgICAgfSwgMjAwMClcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3VycmVudFBsYXllciA9IGNvbXB1dGVyUGxheWVyO1xuICAgICAgICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGAke2NvbXB1dGVyUGxheWVyfWA7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGJlc3RNb3ZlLCA1MDApO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBlbmRHYW1lKCkge1xuICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiBjZWxsLmNsYXNzTGlzdC5hZGQoJ3Rha2VuJykpO1xufVxuXG5yZXN0YXJ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGlzQ29tcHV0ZXJYID0gIWlzQ29tcHV0ZXJYOyAvLyDQp9C10YDQtdC00YPRlNC80L4g0YDQvtC70ZZcbiAgICBpbml0aWFsaXplR2FtZSgpO1xufSk7XG5cbmNlbGxzLmZvckVhY2goY2VsbCA9PiBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ2VsbENsaWNrKSk7XG5cbnNpZGVCdG5zLmZvckVhY2goYnRuID0+IHtcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNpZGUgPSBidG4uZGF0YXNldC5zaWRlO1xuICAgICAgICBpc0NvbXB1dGVyWCA9IHNpZGUgIT09ICdYJzsgLy8g0K/QutGJ0L4g0LPRgNCw0LLQtdGG0YwgWCwg0LrQvtC80L8n0Y7RgtC10YAg0LHRg9C00LUgT1xuICAgICAgICBzaWRlQnRucy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdfYWN0aXZlJykpO1xuICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgnX2FjdGl2ZScpO1xuICAgIH0pO1xufSk7XG5cbnN0YXJ0R2FtZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+e1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaWRlLXNlbGVjdGlvbicpLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG4gICAgZ2FtZUNvbnRhaW5lci5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuICAgIHJlc3RhcnRCdG4uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgIGxhbmRXcmFwcGVyLmNsYXNzTGlzdC5hZGQoXCJfZGVjb3JcIilcbiAgICBzZXRUaW1lb3V0KCgpID0+e1xuICAgICAgICBlbmFibGVNb3VzZVNjYWxlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZWNvcicpKTtcblxuICAgIH0sIDI1MDApXG4gICAgaW5pdGlhbGl6ZUdhbWUoKTtcbiAgICBoaWRlUG9wdXAoXCIjc2lkZS1zZWxlY3Rpb25cIik7XG59KTtcblxuXG5cbmZ1bmN0aW9uIHNob3dQb3B1cChwb3B1cCl7XG4gICAgY29uc29sZS5sb2cocG9wdXApXG4gICAgcG9wdXAgPSBvdmVybGF5LnF1ZXJ5U2VsZWN0b3IocG9wdXApXG5cbiAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJvcGFjaXR5XCIpXG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIilcbn1cblxuZnVuY3Rpb24gaGlkZVBvcHVwKHBvcHVwKXtcbiAgICBwb3B1cCA9IG92ZXJsYXkucXVlcnlTZWxlY3Rvcihwb3B1cClcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoXCJvcGFjaXR5XCIpXG4gICAgcG9wdXAuY2xhc3NMaXN0LmFkZChcImhpZGVcIilcbn1cblxuZnVuY3Rpb24gZW5hYmxlTW91c2VTY2FsZShlbGVtZW50KSB7XG4gICAgY29uc3QgbWluU2NhbGUgPSAxO1xuICAgIGNvbnN0IG1heFNjYWxlID0gMS4wNTtcblxuICAgIGVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC4xcyBlYXNlJztcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBjb25zdCB4ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0O1xuICAgICAgICBjb25zdCB5ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7XG5cbiAgICAgICAgY29uc3QgY2VudGVyWCA9IHJlY3Qud2lkdGggLyAyO1xuICAgICAgICBjb25zdCBjZW50ZXJZID0gcmVjdC5oZWlnaHQgLyAyO1xuXG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5oeXBvdCh4IC0gY2VudGVyWCwgeSAtIGNlbnRlclkpO1xuICAgICAgICBjb25zdCBtYXhEaXN0YW5jZSA9IE1hdGguaHlwb3QoY2VudGVyWCwgY2VudGVyWSk7XG5cbiAgICAgICAgY29uc3Qgc2NhbGUgPSBtaW5TY2FsZSArICgxIC0gZGlzdGFuY2UgLyBtYXhEaXN0YW5jZSkgKiAobWF4U2NhbGUgLSBtaW5TY2FsZSk7XG4gICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7TWF0aC5taW4obWF4U2NhbGUsIE1hdGgubWF4KG1pblNjYWxlLCBzY2FsZSkpfSlgO1xuICAgIH0pO1xuXG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgke21pblNjYWxlfSlgO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBzaG93V2luTGluZShjb21ibykge1xuICAgIGNvbnN0IGxpbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2luLWxpbmUnKTtcbiAgICBsaW5lLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoMCknOyAvLyBSZXNldCBiZWZvcmUgbmV3IGxpbmVcbiAgICBsaW5lLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgIGxpbmUuc3R5bGUuaGVpZ2h0ID0gJzRweCc7XG4gICAgbGluZS5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMGYwZmYnO1xuXG4gICAgLy8g0JrQu9GW0YLQuNC90LrQuCDQvNCw0Y7RgtGMINGW0L3QtNC10LrRgdC4INCy0ZbQtCAwINC00L4gODpcbiAgICAvLyAwIHwgMSB8IDJcbiAgICAvLyAzIHwgNCB8IDVcbiAgICAvLyA2IHwgNyB8IDhcblxuICAgIGNvbnN0IHBvc2l0aW9ucyA9IHtcbiAgICAgICAgJzAsMSwyJzogeyB0b3A6ICcxNi42NiUnLCBsZWZ0OiAnNTAlJywgcm90YXRlOiAnMGRlZycgfSxcbiAgICAgICAgJzMsNCw1JzogeyB0b3A6ICc1MCUnLCBsZWZ0OiAnNTAlJywgcm90YXRlOiAnMGRlZycgfSxcbiAgICAgICAgJzYsNyw4JzogeyB0b3A6ICc4My4zMyUnLCBsZWZ0OiAnNTAlJywgcm90YXRlOiAnMGRlZycgfSxcbiAgICAgICAgJzAsMyw2JzogeyB0b3A6ICc1MCUnLCBsZWZ0OiAnMTYuNjYlJywgcm90YXRlOiAnOTBkZWcnIH0sXG4gICAgICAgICcxLDQsNyc6IHsgdG9wOiAnNTAlJywgbGVmdDogJzUwJScsIHJvdGF0ZTogJzkwZGVnJyB9LFxuICAgICAgICAnMiw1LDgnOiB7IHRvcDogJzUwJScsIGxlZnQ6ICc4My4zMyUnLCByb3RhdGU6ICc5MGRlZycgfSxcbiAgICAgICAgJzAsNCw4JzogeyB0b3A6ICc1MCUnLCBsZWZ0OiAnNTAlJywgcm90YXRlOiAnNDVkZWcnIH0sXG4gICAgICAgICcyLDQsNic6IHsgdG9wOiAnNTAlJywgbGVmdDogJzUwJScsIHJvdGF0ZTogJy00NWRlZycgfSxcbiAgICB9O1xuXG4gICAgY29uc3Qga2V5ID0gY29tYm8uc29ydCgoYSwgYikgPT4gYSAtIGIpLmpvaW4oJywnKTtcbiAgICBjb25zdCBwb3MgPSBwb3NpdGlvbnNba2V5XTtcblxuICAgIGlmIChwb3MpIHtcbiAgICAgICAgbGluZS5zdHlsZS50b3AgPSBwb3MudG9wO1xuICAgICAgICBsaW5lLnN0eWxlLmxlZnQgPSBwb3MubGVmdDtcbiAgICAgICAgbGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZSgke3Bvcy5yb3RhdGV9KSBzY2FsZVgoMSlgO1xuICAgIH1cbn1cblxuXG5cblxuLy8gdGVzdFxuY29uc3QgdGVzdFBvcHVwQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50ZXN0LXBvcHVwJyk7XG5cbnRlc3RQb3B1cEJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcG9wdXBDbGFzcyA9IGJ1dHRvbi5kYXRhc2V0LnBvcHVwO1xuICAgICAgICBjb25zdCBwb3B1cCA9IG92ZXJsYXkucXVlcnlTZWxlY3Rvcihwb3B1cENsYXNzKTtcbiAgICAgICAgY29uc3QgYWxsUG9wdXBzID0gb3ZlcmxheS5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAnKTtcblxuICAgICAgICBjb25zdCBpc0FscmVhZHlPcGVuID0gIXBvcHVwLmNsYXNzTGlzdC5jb250YWlucygnaGlkZScpO1xuXG4gICAgICAgIGlmIChpc0FscmVhZHlPcGVuKSB7XG4gICAgICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ29wYWNpdHknKTtcbiAgICAgICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFsbFBvcHVwcy5mb3JFYWNoKHAgPT4gcC5jbGFzc0xpc3QuYWRkKCdoaWRlJykpO1xuICAgICAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdvcGFjaXR5Jyk7XG4gICAgICAgICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pO1xuXG4iXX0=
